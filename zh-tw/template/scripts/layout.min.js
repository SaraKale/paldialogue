/*
  Copyright Â© 2016 Adobe Systems Incorporated.  All rights reserved.
  Generated by Adobe RoboHelp 2015
*/
(function(){var a,b,c,d,rh;rh=window.rh,b=rh._,a=rh.$,c=rh.consts,d=rh.model,b.getRootUrl=function(){var a;return a=null,function(){return null!=a?a:a=""+b.getHostFolder()+c("START_FILEPATH")}}(),b.runTopicLoadingAnimation=function(){var a,e;return a=null,e=!1,function(f){return e=f,f?(null==a&&(a=b.debounce(function(){return d.publish(c("EVT_TOPIC_LOADING"),e)},700)),a()):(a=null,d.publish(c("EVT_TOPIC_LOADING"),!1))}}(),b.getTopicFrame=function(){var b;return b=window.gTopicFrameName||"rh_default_topic_frame_name",a("[name="+b+"]",0)}}).call(this),function(){var a,b,c,d,e,f,g,rh;rh=window.rh,b=rh._,a=rh.$,c=rh.consts,e=rh.model,e.publish(c("KEY_SHOW_TAGS"),"true"===rh._params.showtags),e.publish(c("KEY_IFRAME_EVENTS"),{click:!0}),f={},d=function(){var a;return a=b.hashParams(),e.publish(c("EVT_HASH_CHANGE"),{oldMap:f,newMap:a},{sync:!0}),f=a},g=function(){var a,d,e,f,g,h;if(g=b.extractParamString(document.location.href),f=b.urlParams(g),d=b.extractHashString(document.location.href),a=b.hashParams(d),e=c("RHMAPNO"),h=c("HASH_KEY_TOPIC"),!(e in f||h in a))return document.location=c("DEFAULT_TOPIC")},b.addEventListener(window,"hashchange",d),b.addEventListener(window,"orientationchange",function(a){var d,f;if(e.publish(c("EVT_ORIENTATION_CHANGE"),null),e.get(c("KEY_SCREEN_IPAD"))&&(f=b.getTopicFrame()))return d=f.style.display,f.style.display="none",f.offsetHeight,b.defer(function(){return f.style.display=d,b.delay(function(){return f.offsetHeight,b.delay(function(){return f.offsetHeight},500)},200)})}),e.subscribe(c("EVT_WIDGET_LOADED"),function(){var a,f,h,i,j,k;return e.subscribe(c("KEY_MERGED_FILTER_KEY"),function(){return new rh.widgets.ExpressionBuilder}),new rh.widgets.BrowseSequenceBuilder,d(),rh.layoutPrint=window.print,window.print=function(){return e.publish(c("EVT_PRINT_TOPIC"),null)},j=b.getFileName(document.location.href),j===c("TOPIC_FILE")&&(i=g())?i:(k=b.getTopicFrame())?k.onload=function(){return e.publish(c("EVT_TOPIC_LOADED"),null)}:(h=b.extractParamString(document.location.href),f=b.urlParams(h),a=c("RHMAPNO"),a in f?document.location=c("TOPIC_FILE")+"?"+h:void 0)}),e.subscribe(c("EVT_BOOKMARK")+"#content_top_placeholder",function(){return e.publish(c("EVT_SCROLL_TO_TOP"),null)}),e.subscribe(c("KEY_PROJECT_LIST"),function(){return rh.filterObject=new rh.MergeProj}),e.subscribe(c("EVT_PROJECT_LOADED"),function(){var a;return a="deviceready",document.addEventListener(a,function(){if(null!=window.cordova)return e.publish(c("KEY_MOBILE_APP_MODE"),!0)})})}.call(this),function(){var a,b,c,d,rh;rh=window.rh,d=rh.model,b=rh._,c=rh.consts,a=function(){function a(){this.tagCombs=[],this.idmap={},this.filter=[],this.grpType="group",this.dataLoaded=!1,this.loadTagData(d.get(c("KEY_PROJECT_LIST"))),this.caption=this.type=this.defFilter=void 0}var e,f;return a.prototype.updateTagCombs=function(a){var e,f;if(f=d.get(c("KEY_PROJECT_TAG_COMBINATIONS")),null!=f)return a=b.parseProjectName(a),null!=(e=this.idmap)[a]?e[a]:e[a]=f},a.prototype.lookup=function(a,b,c){var d,e,f,g,h;if(null==c&&(c=!0),null!=a&&null!=b)for(g=0,h=a.length;g<h&&(d=a[g],null==d||(e=d.name||d.display,c===(null!=d.children)&&e===b?f=d:null==d.children||c||(f=this.lookup(d.children,b,c)),null==f));g++);return f},e=function(a){var b;return b={type:this.grpType,display:a,children:[]}},a.prototype.addTag=function(a,b){var c;if(null==this.lookup(this.filter,b.name,!1))return c={display:b.display,name:b.name},a.push(c)},a.prototype.addGroup=function(a){var b,c,d,f,g;for(c=this.lookup(this.filter,a.display),null==c&&(c=e(a.display),this.filter.push(c)),g=a.children,d=0,f=g.length;d<f;d++)b=g[d],null!=b&&null==b.children&&this.addTag(c.children,b);if(0===c.children.length&&this.filter.indexOf(c)>-1)return this.filter.splice(this.filter.indexOf(c),1)},a.prototype.updateFilter=function(){var a,b,e,f,g;for(a=d.get(c("KEY_TEMP_DATA"))||[],this.caption||(this.caption=a.caption),this.type||(this.type=a.type),"undefined"==typeof this.defFilter&&(this.defFilter=a["default"]),a=a.tags||[],d.publish(c("KEY_TEMP_DATA")),g=[],e=0,f=a.length;e<f;e++)b=a[e],null!=b&&(null!=b.children?g.push(this.addGroup(b)):g.push(this.addTag(this.filter,b)));return g},f=function(a,b){if(this.updateTagCombs(a),this.updateFilter(),!b)return d.publish(c("KEY_MERGED_FILTER_KEY"),this.filter),d.publish(c("KEY_MERGED_PROJECT_MAP"),this.idmap),d.publish(c("KEY_PROJECT_FILTER_CAPTION"),this.caption),d.publish(c("KEY_PROJECT_FILTER_TYPE"),this.type),d.publish(c("KEY_DEFAULT_FILTER"),this.defFilter),this.dataLoaded=!0},a.prototype.loadTagData=function(a){var d,e,g,h,i;if(!this.dataLoaded){for(d=a.length,i=[],e=0,g=a.length;e<g;e++)h=a[e],null!=h?(h&&(h+="/"),i.push(b.loadScript(""+h+c("PATH_PROJECT_TAGDATA_FILE"),!1,f.bind(this,h,--d)))):i.push(void 0);return i}},a}(),rh.MergeProj=a}.call(this),function(){var a,b,c,d,rh,e,f,g=function(a,b){return function(){return a.apply(b,arguments)}};rh=window.rh,c=rh._,a=rh.$,d=rh.consts,e=rh.storage,f=rh._params.filter,b=function(){function a(a){this.handleTagStates=g(this.handleTagStates,this),this.getUnchecked=g(this.getUnchecked,this),e.init(d("HELP_ID")),this.allTagNames=this.computeNames(rh.model.get(d("KEY_MERGED_FILTER_KEY"))),this.prepareTagStates(),this.handleTagStates(rh.model.get(d("KEY_PROJECT_TAG_STATES"))),rh.model.subscribe(d("KEY_PROJECT_TAG_STATES"),c.debounce(this.handleTagStates,300),{initDone:!0})}var b,h,i;return h=":",i=";",b=",",a.prototype.computeNames=function(a){return c.reduce(a,function(a,b){return a.push(b.children?this.computeNames(b.children):b.name),a},[],this)},a.prototype.getUnchecked=function(a,b){return c.filter(this.allTagNames[a],function(a){return-1===b.indexOf(a)})},a.prototype.computeExpression=function(a){var b;return a&&this.allTagNames?(b=c.reduce(a,function(a,b,d){var e;return c.isString(b)?a.push({c:[b],u:[]}):null!=b&&(e=c.compact(b))&&e.length>0&&a.push({c:e,u:this.getUnchecked(d,e)}),a},[],this),rh.model.publish(d("KEY_TAG_EXPRESSION"),b)):rh.model.publish(d("KEY_TAG_EXPRESSION"),[])},a.prototype.handleTagStates=function(a){return null==a&&(a={}),this.computeExpression(a),e.persist("tag_states",a)},a.prototype.prepareTagStates=function(){return rh.model.subscribe(d("KEY_PROJECT_FILTER_TYPE"),function(a){return function(){var g,h;if(f&&(g=rh.model.get(d("KEY_MERGED_FILTER_KEY")),h=a.parseUrlFilter(g,f.split(b))),h||(h=e.fetch("tag_states")),h||(h=c.clone(rh.model.get(d("KEY_DEFAULT_FILTER")))),h)return rh.model.publish(d("KEY_PROJECT_TAG_STATES"),h)}}(this))},a.prototype.parseFilterElemnt=function(a,b){var d,e,f,g;return g=b.split(h),f=g[0],d=g[1]&&g[1].split(i),e=c.findIndex(a,function(a){return null!=d==(null!=a.children)&&a.display===f}),{index:e,elements:d}},a.prototype.parseUrlFilter=function(a,b){var e,f;if(b||b.length)return f="radio"===rh.model.get(d("KEY_PROJECT_FILTER_TYPE")),e=!0,c.reduce(b,function(b,c,d){var g,h,i;return i=this.parseFilterElemnt(a,c),d=i.index,g=i.elements,d!==-1&&(h=a[d],h.children?b[d]=this.parseUrlFilter(h.children,g):f&&!e||(e=!1,b[d]=h.name)),b},{},this)},a}(),rh.widgets.ExpressionBuilder=b}.call(this),function(){var a,b,c,rh;rh=window.rh,c=rh._,a=rh.$,b=function(){function a(){var a,b;a=function(a){var b,d,e,f;if(b=rh.model.get("t.brsmap"),null!=b)return e=b.n&&b.n[0]||"",f=b.p&&b.p[0]||"",d=window.decodeURI(document.location.href),c.isEmptyString(e)||(e=window._getRelativeFileName(d,e)),c.isEmptyString||(f=window._getRelativeFileName(d,f)),rh.model.publish("l.brsBack",f),rh.model.publish("l.brsNext",e)},b=function(){var a,b,c,d;return d=rh.model.get(rh.consts("KEY_UI_MODE")),b=rh.model.get("l.brsBack"),a=rh.model.get("l.brsNext"),c=!(d||!b&&!a),rh.model.publish("l.show_brs",c)},rh.model.subscribe("t.topicurl",c.debounce(a,200)),rh.model.subscribe("t.brsmap",c.debounce(a,200)),rh.model.subscribe("l.brsBack",b),rh.model.subscribe("l.brsNext",b),rh.model.subscribe(rh.consts("KEY_UI_MODE"),b)}return a}(),rh.widgets.BrowseSequenceBuilder=b}.call(this),function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,rh,u,v,w;rh=window.rh,h=rh._,a=rh.$,i=rh.consts,r=rh.model,d=i("HASH_KEY_RH_SEARCH"),f=i("HASH_KEY_TOPIC"),g=i("HASH_KEY_UIMODE"),e=i("HASH_KEY_RH_TOCID"),c=i("HASH_KEY_RH_HIGHLIGHT"),b=i("HASH_KEY_RANDOM"),q=[c,i("HASH_KEY_RH_SYNS"),e],m=function(a){var b,c;return c=h.urlParams(h.extractParamString(a)),b=h.hashParams(h.extractHashString(a)),h.extend(c,b)},o=function(a,c){var d,e,f,g,j,k,l;for(c=c,e=h.filePath(c),d=h.extractHashString(c),d.length>0&&(d="#"+d),l=h.urlParams(h.extractParamString(c)),f=0,j=q.length;f<j;f++)g=q[f],null!=a[g]&&(l[g]=a[g]);return r.get(i("KEY_SCREEN_IOS"))&&(l[b]=h.uniqueId()),k=h.mapToEncodedString(l),k.length>0&&(k="?"+k),""+e+k+d},t=h.queueUpdateHashMap,k=function(a){return null==a&&(a={}),a[g]=null,a[b]=null,a[e]||(a[e]=null),a[c]||(a[c]=null),a},j=function(a){return null==a&&(a={}),a[g]||(a[g]=null),a[b]=null,a[e]||(a[e]=null),a[c]||(a[c]=null),a[d]||(a[d]=null),a},v=function(a,b){var c;return a=h.fixRelativeUrl(a),c=h.urlParams(h.extractParamString(a)),c[f]=h.stripParam(a),c=k(c),t(c,b)},l=function(a){var b;return a=h.fixRelativeUrl(a),b=h.urlParams(h.extractParamString(a)),b=j(b)},n=function(a){var b;return b=l(a),h.isEmptyObject(b)?"":"?"+h.mapToEncodedString(b)},u=function(a,b){var c;return c={},c[f]=a,c=k(c),t(c,b)},p=function(a){var b,j,k,l,m,n,p,q,s,t;return j=a.newMap,k=a.oldMap,m=k[g],t=j[g],d in j&&(p=j[d],q=p!==r.get(i("KEY_SEARCHED_TERM")),r.publish(i("KEY_SEARCH_TERM"),p,{sync:!0})),"search"===t&&q&&window.gHost&&r.publish(i("EVT_QUERY_SEARCH_RESULTS"),!0),t&&!j[f]||(l=r.get(i("KEY_TOPIC_IN_IFRAME")),f in j&&(s=j[f]),s||(s=l),s||(s=null!=(n=window.gDefaultTopic)?n.substring(1):void 0),b=s&&(s!==l||m!==t||k[c]!==j[c]||k[e]!==j[e]),b&&(h.stripBookmark(s)!==h.stripBookmark(l)&&h.runTopicLoadingAnimation(!0),r.publish(i("KEY_TOPIC_IN_IFRAME"),s),window.loadTopic(o(j,s)))),r.publish(i("KEY_UI_MODE"),j[g])},w=function(a){var b,c,d,e;if(c=h.hashParams(),a&&!c[g]&&(b=decodeURI(document.location.href),e=window._getRelativeFileName(b,a),d=c[f],!d||h.filePath(e)!==h.filePath(d)))return r.publish(i("KEY_TOPIC_IN_IFRAME"),e),v(e,!1)},s=function(a){var b,c,d,e,f,j;return j=a.absUrl,h.isRootUrl()?h.isUrlAllowdInIframe(j)?(j=h.makeRelativeUrl(h.fixRelativeUrl(j)),b=j&&h.filePath(j),b===i("START_FILEPATH")?j=j.substring(b.length):j||(j="#ux"),"#"===j[0]||"?"===j[0]?(c=h.hashParams(h.extractHashString(j)),g in c||(c[g]=null),t(c,!0)):j?v(j,!0):void 0):u(j,!0):(h.isRootUrl(j)||(f=h.getRootUrl(),h.isExternalUrl(j)?e=j:(d=n(j),e=h.fixRelativeUrl(h.makeRelativePath(j,f))),j=""+f+d+"#t="+encodeURIComponent(e)),document.location.href=j)},r.subscribe(i("EVT_WIDGET_LOADED"),function(){return h.addEventListener(document,"click",h.hookClick),r.subscribe(i("EVT_HASH_CHANGE"),p),r.subscribe(i("KEY_TOPIC_URL"),w),r.subscribe(i("EVT_NAVIGATE_TO_URL"),s),r.subscribe(i("KEY_TOPIC_IN_IFRAME"),function(a){if(""+window.gHost+window.gHostPath!="/"&&(window.setTopic&&window.setTopic(),window.changeTopicLink))return window.changeTopicLink(document.location.toString())}),r.subscribe(i("EVT_TOPIC_LOADED"),function(){return h.runTopicLoadingAnimation(!1)}),r.subscribe(i("EVT_INSIDE_IFRAME_DOM_CONTENTLOADED"),function(){return h.runTopicLoadingAnimation(!1)})})}.call(this),function(){var a,b,c,d,rh,e,f;rh=window.rh,b=rh._,a=rh.$,c=rh.consts,d=rh.model,e=rh.rhs,f=null,f=d.subscribe(c("KEY_TAG_EXPRESSION"),function(){var a;return a=!1,function(){if(f&&f(),!a)return a=!0,d.subscribe(c("KEY_SEARCHED_TERM"),function(){return d.publish(c("KEY_ONSEARCH_TAG_EXPR"),JSON.stringify(d.get(c("KEY_TAG_EXPRESSION"))))})}}()),d.subscribe(c("EVT_SEARCH_TERM"),function(){var a,e,f;return a=d.get(c("KEY_CAN_HANDLE_SEARCH")),f=d.get(c("KEY_SEARCH_TERM"))||null,e={},e[c("HASH_KEY_RH_SEARCH")]=f,e[c("HASH_KEY_UIMODE")]="search",a!==!0?document.location=window.gRootRelPath+"/"+(window.gSearchPageFilePath||c("START_FILEPATH"))+("?#"+b.mapToEncodedString(e)):(d.publish(c("EVT_QUERY_SEARCH_RESULTS"),!0),b.defer(function(){return b.updateHashMap(e,!0)}))}),d.subscribe(c("EVT_PROJECT_LOADED"),function(){return window.readSetting&&window.readSetting(RHANDSEARCH,function(a){return d.publish(c("KEY_AND_SEARCH"),a)}),d.subscribe(c("KEY_AND_SEARCH"),function(a){return saveSetting(RHANDSEARCH,"1"===a?"1":"0",!0)})}),d.subscribe(c("EVT_QUERY_SEARCH_RESULTS"),function(){if(!e.doSearch())return window.doSearch()})}.call(this),function(){var a,b,c,rh;rh=window.rh,b=rh._,a=rh.$,c=rh.consts,rh.model.subscribe(c("EVT_WIDGET_BEFORELOAD"),function(){var b;if(null!==a("a.wShow",0))return b=a(".contenttopic",0),a.setAttribute(b,"data-rhwidget","Basic"),a.setAttribute(b,"data-class","govt_csh:@.l.csh_mode;govt_nocsh:!@.l.csh_mode")})}.call(this),function(){var a,b,c,d,rh,e=function(a,b){return function(){return a.apply(b,arguments)}};rh=window.rh,c=rh._,a=rh.$,d=rh.consts,b=function(){function b(a){this.widget=a,this.click=e(this.click,this)}var f,g,h;return f="group",g="item",h=d("KEY_PROJECT_FILTER_TYPE"),b.prototype.click=function(a){var b,e,f,g,h;return h=a.currentTarget,b=a.target,e=this.getItemNode(b,h),g=""+d("KEY_PROJECT_TAG_STATES")+this.getItemKey(e),f=this.widget.get(g),"radio"!==this.filterType()?this.handleCheckboxClick(e,g,f):this.handleRadioClick(e,g,f),c.preventDefault(a)},b.prototype.handleRadioClick=function(a,b,d){var e,f,g,h;if(!this.isGroupNode(a)&&!d)return h=c.splitKey(b),g=h.parentKey,e=h.key,f={},f[e]=this.getItemValue(a),this.widget.publish(g,f)},b.prototype.handleCheckboxClick=function(a,b,d){var e,f;return this.isGroupNode(a)?(e=c.any(d,function(a){return a}),f=e?void 0:this.getGroupItemExprs(a),this.widget.publish(b,f)):(f=d?void 0:this.getItemValue(a),this.widget.publish(b,f))},b.prototype.getItemNode=function(b,d){return c.findParentNode(b,d,function(b){return"LI"===a.nodeName(b)})},b.prototype.getItemValue=function(b){return a.dataset(b,"itemvalue")},b.prototype.getGroupItemExprs=function(b){var d,e;return e=a.dataset(b,"itemkey"),d=this.widget.get(""+this.widget.key+e),c.map(d.children,function(a){return a.name})},b.prototype.getItemKey=function(b){return a.dataset(b,"itemkey")},b.prototype.isGroupNode=function(b){return a.hasClass(b,f)},b.prototype.isItemNode=function(b){return a.hasClass(b,g)},b.prototype["class"]=function(a){return a.children?f:g},b.prototype.value=function(a){return a.children?null:a.name},b.prototype.filterType=function(){return this.widget.get(h)||"checkbox"},b.prototype.inputType=function(a){var b;return b=this.filterType(),a.children&&"radio"===b&&(b=void 0),b},b}(),rh.controller("FilterController",b)}.call(this),function(){var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a){this.widget=a,this.triggerDelayLoadWidgets=b(this.triggerDelayLoadWidgets,this),this.init(),this.subscribeActiveTab(),this.subscribeToLocations(),this.subscribeScreens(),this.widget.subscribe(p("EVT_PROJECT_LOADED"),function(a){return function(){return a.subscribeUIMode(),a.subscribeMergedFilter(),a.subscribeTopicClick(),a.subscribeTopicScroll(),a.subscribForSearchResult(),a.subscribeTopicNavigate(),a.subscribeToDelayLoadEvents(),a.widget.publish(p("KEY_IFRAME_EVENTS"),{click:!0,scroll:!1})}}(this))}var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,rh,r,s;return rh=window.rh,o=rh._,c=rh.$,p=rh.consts,f=p("KEY_FEATURE"),g=p("KEY_FILTER_LOCATION"),i=p("KEY_SEARCH_LOCATION"),e=p("KEY_ACTIVE_TAB"),k=p("KEY_UI_MODE"),h=p("KEY_MOBILE_TOC_DRILL_DOWN"),j=p("KEY_TOC_DRILL_DOWN"),d="desktop",n="tablet",l="phone",m="filter"!==rh._params.hideUI,s={desktop:["toc","idx","glo","filter","fts"],tablet:["toc","idx","glo","filter","fts"],phone:["toc","idx","glo","filter","fts"]},r={desktop:["toc","idx","glo","filter","fts"],tablet:["toc","idx","glo","filter","fts"],phone:["toc","idx","glo"]},q={idx:{evt:"EVT_LOAD_IDX",f_key:"delay_load_idx"},glo:{evt:"EVT_LOAD_GLO",f_key:"delay_load_glo"}},a.prototype.init=function(){return this.screens=this.widget.get(p("KEY_SCREEN_NAMES")),rh.storage.init(p("HELP_ID")),this.activeScreen=o.find(this.screens,function(a){return this.widget.get(p("KEY_SCREEN")+"."+a+".attached")},this),null==this.activeScreen&&(this.activeScreen=this.widget.get(p("KEY_DEFAULT_SCREEN"))),this.assureLocations(this.activeScreen),this.initDefauls(),this.initActiveTab()},a.prototype.initDefauls=function(){var a;return a=this.widget.get(p("KEY_DEFAULT_TAB")),this.hasFeature(a)||(a=null),this.defaultTabs={},o.each(this.screens,function(b){return s[b]=o.filter(s[b],function(a){return this.hasFeature(a)},this),r[b]=o.filter(r[b],function(a){return this.hasFeature(a)},this),this.defaultTabs[b]=a&&-1!==s[b].indexOf(a)?a:s[b][0]},this)},a.prototype.initActiveTab=function(){var a;if(a=rh.storage.fetch("activetab"),void 0!==a&&a&&this.hasFeature(a))return this.widget.publish(e,a)},a.prototype.isValidTab=function(a,b){return null==b&&(b=this.activeScreen),!(!a||!this.hasFeature(a))&&((b!==d||!("filter"===a&&"content"===this.widget.get(g)||"fts"===a&&"content"===this.widget.get(i)))&&-1!==s[b].indexOf(a))},a.prototype.defaultTab=function(a){var b;return null==a&&(a=this.activeScreen),b=this.defaultTabs[a],this.isValidTab(b)||(b=o.find(s[a],function(a){return this.isValidTab(a)},this)),b},a.prototype.assureValidActiveTab=function(a){var b;if(null==a&&(a=this.activeScreen),b=this.widget.get(e),a===d||b)return this.isValidTab(b)||(b=this.defaultTab()),this.widget.publish(e,b)},a.prototype.toggleSideBar=function(){return this.widget.get(e)?this.widget.publish(e,null):this.widget.publish(e,this.lastMobileTab||this.defaultTab())},a.prototype.toggleActiveTab=function(a){return this.widget.publish(e,this.isDesktopScreen()||a!==this.widget.get(e)?a:null)},a.prototype.triggerDelayLoadWidgets=function(a){var b;if(b=q[a],b&&this.hasFeature(b.f_key))return this.widget.publish(p(b.evt),!0)},a.prototype.subscribeToDelayLoadEvents=function(){return this.widget.subscribe(e,this.triggerDelayLoadWidgets)},a.prototype.filterDone=function(){return this.widget.publish(e,this.searchMode?"fts":null)},a.prototype.hasFeature=function(a){return void 0===a||!1!==this.widget.get(f+"."+a)},a.prototype.subscribeUIMode=function(){var a;if(a=function(a){return function(){if(a.isValidTab("fts"))return a.isDesktopScreen()&&"tabbar"!==a.widget.get(i)?void 0:a.widget.publish(e,"fts")}}(this),this.widget.subscribe(k,function(a){return function(b){return a.widget.publish("active_content",b)}}(this)),this.widget.subscribe("active_content",function(b){return function(c){return b.isMobileScreen()&&!c?b.widget.publish(e,null):"search"===c?a():void 0}}(this),{initDone:!0}),"search"===this.widget.get("active_content"))return a()},a.prototype.subscribeMergedFilter=function(){var a;if(this.widget.get(a=f+".filter"))return this.widget.subscribe(p("KEY_MERGED_FILTER_KEY"),function(b){return function(c){return b.widget.publish(a,!!(c&&c.length&&m)),b.assureValidActiveTab()}}(this))},a.prototype.subscribeTopicClick=function(){return this.widget.subscribe(p("EVT_CLICK_INSIDE_IFRAME"),function(a){return function(){if(a.activeScreen===l&&a.widget.get(e))return a.toggleSideBar()}}(this))},a.prototype.subscribeTopicNavigate=function(){return this.widget.subscribe(p("EVT_NAVIGATE_TO_URL"),function(a){return function(b){if(b.absUrl&&o.isUrlAllowdInIframe(b.absUrl))return a.widget.publish("active_content",null)}}(this))},a.prototype.subscribeTopicScroll=function(){return this.widget.subscribe(p("EVT_SCROLL_INSIDE_IFRAME"),function(a){return function(b){var c,d;return c="down"===b.dir||b.scrollTop>10,a.widget.publish("hide_header",c),d="down"===b.dir&&b.scrollTop>10,a.widget.publish("hide_mobile_functions",d)}}(this))},a.prototype.subscribeActiveTab=function(){return this.widget.subscribe(e,function(a){return function(b){return rh.storage.persist("activetab",b),a.isMobileScreen()?(a.isSidebarTab(b)&&(a.lastMobileTab=b),a.searchMode="fts"===b||a.searchMode&&"filter"===b):a.searchMode=!1}}(this))},a.prototype.subscribeScreens=function(){return o.each(this.screens,function(a){var b;return b=p("KEY_SCREEN")+"."+a+".attached",this.widget.get(b)&&this.handleScreen(!0,a),this.widget.subscribe(b,function(b){return function(c){return b.handleScreen(c,a)}}(this),{initDone:!0})},this)},a.prototype.subscribeToLocations=function(){return this.widget.subscribe(i,function(a){return function(){return a.assureValidActiveTab(a.activeScreen)}}(this)),this.widget.subscribe(g,function(a){return function(){return a.assureValidActiveTab(a.activeScreen)}}(this))},a.prototype.subscribForSearchResult=function(){var a;return a=function(a){return function(){var b,c;if(c=a.widget.get(p("KEY_TAG_EXPRESSION")),b=a.widget.get(p("KEY_ONSEARCH_TAG_EXPR")),b&&b!==JSON.stringify(c))return a.widget.publish(p("EVT_SEARCH_TERM"),!0)}}(this),this.widget.subscribe(p("KEY_TAG_EXPRESSION"),o.debounce(function(b){return function(){if((!b.isValidTab("fts")||"fts"===b.widget.get(e))&&b.isSearchMode(b.widget.get(e)))return a()}}(this),300)),this.widget.subscribe(e,function(b){if("fts"===b)return a()})},a.prototype.isMobileScreen=function(){return this.activeScreen===l},a.prototype.isDesktopScreen=function(){return this.activeScreen===d},a.prototype.isTabletScreen=function(){return this.activeScreen===n},a.prototype.isSidebarTab=function(a){return a&&-1!==r[this.activeScreen].indexOf(a)},a.prototype.isSearchMode=function(a){var b;return b=this.widget.get("active_content"),"fts"===a||"search"===b&&this.isDesktopScreen()&&"content"===this.widget.get(i)},a.prototype.handleScreen=function(a,b){return a?(this.activeScreen=b,this.handleAttached(b)):this.handleDetached(b)},a.prototype.handleDetached=function(a){return o.defer(function(b){return function(){if(a===d)return b.widget.publish(e,"search"===b.widget.get("active_content")&&b.isValidTab("fts")?"fts":null)}}(this))},a.prototype.handleAttached=function(a){return this.assureLocations(a),this.assureValidActiveTab(a),this.assureTOCMode(a)},a.prototype.assureLocations=function(a){return null==a&&(a=this.activeScreen),this.widget.publish(i,a===d?this.widget.get(p("KEY_DEFAULT_SEARCH_LOCATION")):a===n?"tabbar":"content"),this.widget.publish(g,a===d||a===n?"tabbar":"content")},a.prototype.assureTOCMode=function(a){return null==a&&(a=this.activeScreen),this.widget.publish(j,a!==d&&this.widget.get(h))},a.prototype.newSearch=function(a,b,c){var d;if(13===b&&(d=this.widget.get(p("KEY_SEARCH_TERM")),d!==a&&this.widget.publish(p("KEY_SEARCH_TERM"),a),this.widget.publish(p("EVT_SEARCH_TERM"),!0),null!=c?c.target:void 0))return c.target.blur()},a.prototype.isTagStatesChanged=function(){var a,b;return a=o.compactObject(this.widget.get(p("KEY_PROJECT_TAG_STATES"))),b=o.compactObject(this.widget.get(p("KEY_DEFAULT_FILTER"))),!o.isEqual(a,b)},a.prototype.setDefaultTagStates=function(){var a;return a=this.widget.get(p("KEY_DEFAULT_FILTER")),this.widget.publish(p("KEY_PROJECT_TAG_STATES"),o.clone(a))},a}(),window.rh.controller("ModernLayoutController",a)}.call(this),function(){var a;a=function(){function a(a,d){var e;e=(null!=d?d.removeClasses:void 0)||["hide-children","loading"],c.each(e,function(c){return b.removeClass(a.node,c)}),c.each(null!=d?d.addClasses:void 0,function(c){return b.addClass(a.node,c)})}var b,c,rh;return rh=window.rh,b=rh.$,c=rh._,a}(),window.rh.controller("JsLoadingController",a)}.call(this),function(){var a,b,c,d,e,f,rh,g,h,i=function(a,b){return function(){return a.apply(b,arguments)}},j=function(a,b){function c(){this.constructor=a}for(var d in b)k.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},k={}.hasOwnProperty;rh=window.rh,f=rh.model,c=rh._,d=rh.consts,e=rh.http,g=rh.rhs,h="topics",b=function(){function a(){this.updateData=i(this.updateData,this)}return a.prototype.lookup=function(a,b){var d,e,f,g;if(null!=a&&null!=b)for(f=0,g=a.length;f<g&&(d=a[f],null==d||(b.type===d.type&&b.name===d.name&&c.isEqual(b.url,d.url)&&c.isEqual(b[h],d[h])&&(e=d),null==e));f++);return e},a.prototype.sort=function(a){return a.sort(function(a,b){return window.compare(a.name,b.name)})},a.prototype.updateData=function(a,b){var c;if(c=f.get(d("KEY_TEMP_DATA"))||[],f.publish(d("KEY_TEMP_DATA")),this.addElement(c,this.data,b,this.keys),0===--this.chunkCount&&0===this.count)return this.sort(this.data),f.publish(d(a),this.data)},a.prototype.getChunkData=function(a,b){var e,g;return this.count--,e=(null!=(g=f.get(d("KEY_TEMP_DATA")))?g.chunkinfos:void 0)||[],this.chunkCount+=e.length,c.each(e,function(d){return a&&(a=c.ensureSlash(a)),c.loadScript(a+"whxdata/"+d.node+".new.js",!1,function(c){return function(){return c.updateData(b,a)}}(this))},this)},a.prototype.loadNavData=function(a){return f.subscribe(d("KEY_PROJECT_LIST"),function(b){return function(d){return b.alhpabet="",b.count+=d.length,c.each(d,function(b){return b&&(b=c.ensureSlash(b)),c.loadScript(b+"whxdata/"+("ndx"===a?"idx":"glo")+".new.js",!1,function(c){return function(){return c.getChunkData(b,"ndx"===a?"PROJECT_INDEX_DATA":"PROJECT_GLOSSARY_DATA")}}(this))},b)}}(this))},a}(),rh.NavController=b,a=function(a){function b(a){this.data=[],this.chunkCount=0,this.count=0,this.alhpabet="",this.filter="",this.keys="keys",this.widget=a,f.subscribeOnce(d("EVT_PROJECT_LOADED"),function(a){return function(){return a.loadNavData("ndx"),a.getIndexData(),f.subscribe(d("KEY_INDEX_FILTER"),function(){return a.alhpabet="",f.publish(d("PROJECT_INDEX_DATA"),f.get(d("PROJECT_INDEX_DATA")))})}}(this))}var i;return j(b,a),i="",b.prototype.addElement=function(a,b,d,e){var f,g,j,k,l,m,n,o;if(null!=a[e]){for(m=a[e],o=[],j=0,k=m.length;j<k;j++)f=m[j],null!=f&&((g=this.lookup(b,f))||(l={type:f.type,name:f.name},f["data-rhtags"]&&(l["data-rhtags"]=f["data-rhtags"]+"+"+d),f.url||(l[h]=[]),n=c.makeRelativeUrl(""+d,i),null!=f.url&&(l.url=""+encodeURI(n)+f.url),null==f.url&&(l[this.keys]=[]),b.push(l),g=b[b.length-1]),this.addElement(f,g[this.keys],d,this.keys),o.push(this.addElement(f,g[h],d,h)));return o}},b.prototype.showItem=function(a){var b;return b=f.get(d("KEY_INDEX_FILTER")),!b||a.toLocaleLowerCase().indexOf(b.toLocaleLowerCase())!==-1},b.prototype.showCategory=function(a,b){var c;return!(b>0)&&(c=this.alphaText(a),!(this.alhpabet.indexOf(c)>-1)&&(this.alhpabet+=c,!0))},b.prototype.showNextLevel=function(a){var b,c,d,e;for(c=a.getAttribute("data-indexid"),e=this.widget.get("show."+c),d={},d[""+c]=!e,b=d;c;)c=c.substr(0,c.lastIndexOf("_")),b[c]=!0;return this.widget.publish("show",b)},b.prototype.alphaText=function(a){return a.toUpperCase().charAt(0)},b.prototype.getIndexData=function(){return f.subscribeOnce(d("KEY_PUBLISH_BASE_URL"),function(){var a,b,h,i,j,k,l;try{if(b=f.get(d("KEY_PUBLISH_BASE_URL")),k=document.location.origin,a=b.substr(k.length),l=c.parentPath(c.filePath(c.getRootUrl())),a&&!c.isEmptyString(a))return j=c.mapToEncodedString(c.extend({area:g.area(),prj:g.project(),type:g.type(),agt:"ndx",mgr:"agm"})),e.get(a+"?"+j).success(function(a,b){var e;return a=JSON.parse(a),e=[],c.each(a,function(b){return a[0]=c.ensureSlash(a[0]),e.push(c.makeRelativeUrl(b,a[0]))}),f.publish(d("KEY_PROJECT_LIST"),e)})}catch(i){if(h=i,rh._debug)return rh._d("warn",h.message)}})},b}(rh.NavController),rh.controller("IndexController",a)}.call(this),function(){var a,b,c,d,e,rh,f=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},g={}.hasOwnProperty;rh=window.rh,e=rh.model,b=rh._,c=rh.consts,d=rh.http,a=function(a){function b(a){this.data=[],this.chunkCount=0,this.count=0,this.keys="",this.alhpabet="",this.loadNavData("glo"),this.filter="",this.widget=a,this.widget.publish("show",{})}var d;return f(b,a),d="entrys",b.prototype.addElement=function(a,b){var c,e,f,g,h;for(g=a[d],h=[],e=0,f=g.length;e<f;e++)c=g[e],null!=c&&(this.lookup(b,c)?h.push(void 0):h.push(b.push(c)));return h},b.prototype.exists=function(a){var b;return b=this.alphaText(a),this.alhpabet.indexOf(b)>-1||(this.alhpabet+=b,!1)},b.prototype.isFiltered=function(a){return this.filter&&a.toLocaleLowerCase().indexOf(this.filter)===-1},b.prototype.alphaText=function(a){return a.toUpperCase().charAt(0)},b.prototype.filterGlo=function(a){return this.filter=a.toLocaleLowerCase(),this.alhpabet="",e.publish(c("PROJECT_GLOSSARY_DATA"),e.get(c("PROJECT_GLOSSARY_DATA")))},b}(rh.NavController),rh.controller("GlossaryController",a)}.call(this),function(){var a,b,c,d,e,rh,f;rh=window.rh,e=rh.model,b=rh._,c=rh.consts,d=rh.http,f=rh.rhs,new(a=function(){function a(){var a;a=3e3,e.subscribeOnce(c("EVT_PROJECT_LOADED"),function(){return e.subscribeOnce(c("KEY_PUBLISH_MODE"),function(f){var h,i,j;if(f)return j=j||g(),h=[],i=b.debounce(function(){return d.post(j,JSON.stringify(h)).error(function(a,b){if(rh._debug)return rh._d("error","Filter report status ",b)})},a,!1),e.subscribe(c("KEY_TAG_EXPRESSION"),function(a){var b,d,e,f,g,j,k,l,m;for(h=[],b=rh.model.get(c("KEY_MERGED_FILTER_KEY")),d=0,f=a.length;d<f;d++)for(m=a[d],j=m.c,e=0,g=j.length;e<g;e++)k=j[e],(l=rh.filterObject.lookup(b,k,!1))&&h.push(l.display);if(h.length>0)return i()})})})}var g;return g=function(){var a,d,g;if(g=document.location.origin,a=e.get(c("KEY_PUBLISH_BASE_URL")).substr(g.length),a&&!b.isEmptyString(a))return d=b.mapToEncodedString(b.extend({area:f.area(),prj:f.project(),type:f.type(),agt:"fltRpt",mgr:"agm"})),a+"?"+d},a}())}.call(this),function(){var a,b,c,d,rh;rh=window.rh,b=rh._,d=rh.model,c=rh.consts,a=function(){function a(){l.push("."),m.push("."),h()}var e,f,g,h,i,j,k,l,m;return l=[],m=[],k="projectdata.js",f="remote",e="project",g="url",j=0,i=function(a){var i;return i=a+"/"+k,window.xmlJsReader.loadFile(i,function(a,i){var k,n,o;if(k=0,j++,null!=a&&(n=a.getElementsByTagName(e)[0],o=n.getElementsByTagName(f),k=o.length),b.each(o,function(a){var b;return b=i+"/"+a.getAttribute(g),l.push(b),m.push(b)}),h(),0===m.length&&j===l.length)return d.publish(c("KEY_PROJECT_LIST"),l)},a)},h=function(){var a,b;for(b=[];m.length>0;)a=m.splice(0,1),b.push(i(a));return b},a}(),d.subscribe(c("EVT_PROJECT_LOADED"),function(){return b.defer(function(){if(!d.get(c("KEY_PUBLISH_MODE"))&&!window.gbPreviewMode)return new a})})}.call(this),function(a,b,c){"use strict";function d(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();!function g(a,b,c){function d(f,h){if(!b[f]){if(!a[f]){var i="function"==typeof require&&require;if(!h&&i)return i(f,!0);if(e)return e(f,!0);var j=new Error("Cannot find module '"+f+"'");throw j.code="MODULE_NOT_FOUND",j}var k=b[f]={exports:{}};a[f][0].call(k.exports,function(b){var c=a[f][1][b];return d(c?c:b)},k,k.exports,g,a,b,c)}return b[f].exports}for(var e="function"==typeof require&&require,f=0;f<c.length;f++)d(c[f]);return d}({1:[function(a,b,c){var rh=a("../../src/lib/rh"),d=rh._;d.findEditDist=function(a,b){if(a==b)return 0;for(var c=[],d=[],e=0;e<b.length+1;e++)c.push(e),d.push(0);for(var e=0;e<a.length;e++){d[0]=e+1;for(var f=0;f<b.length;f++){var g=void 0;g=a[e]==b[f]?0:1,d[f+1]=Math.min(d[f]+1,c[f+1]+1,c[f]+g)}for(var f=0;f<c.length;f++)c[f]=d[f]}return d[d.length-1]}},{"../../src/lib/rh":3}],2:[function(a,b,c){var d=function(a,b){return function(){return a.apply(b,arguments)}},rh=a("../../src/lib/rh"),g=a("../../src/responsive_help/utils/node_utils"),h=rh._,i=rh.$,j=rh.model,k=rh.consts,l=k("KEY_TOC_DRILL_DOWN"),m=700,n=void 0,o=void 0;n=function(){var a=function(){function a(){e(this,a)}return f(a,[{key:"sync",value:function(a,b){var c=void 0;return a.updateActiveBookInfo(0,"_"),c=a.widget.node,this.reset(b),this.syncToProjectToc(a,c.children,function(b){return function(c){return b.syncToTocItem(a,c)}}(this))}},{key:"reset",value:function(a){var b=void 0;return this.parseTocInfo(a),b=this.order.lastIndexOf("@"),
this.parentOrder=b!==-1?this.order.substring(0,b):""}},{key:"parseTocInfo",value:function(a){var b=void 0;return this.order=a.childOrder||"",b=h.splitAndTrim(a.childPrefix,"."),this.tocPath=h.reduce(b,function(a,b){var c=void 0,d=void 0;return c=h.splitAndTrim(b,"@"),(d=c.shift())&&a.push({bookNo:h.parseInt(d,0),order:c.length>0?"@"+c.join("@"):""}),a},[]),b=h.splitAndTrim(a.topicID||"0","_"),this.bookNos=h.map(b.shift().split("."),function(a){return h.parseInt(a,0)}),this.pageNo=h.parseInt(b.shift(),0)}},{key:"syncToProjectToc",value:function(a,b,c){var d=void 0,e=void 0,f=void 0;if(this.tocPath.length>0){if(d=0,f=this.tocPath.shift(),e=h.findIndex(b,function(b){var c=void 0;return c=i.dataset(b,"childorder")||"",!(c!==f.order||!a.isBookNode(b)||(d++,d!==f.bookNo))}),e!==-1)return a.openBook(b[e],!0,function(d){return function(){return h.defer(function(){var f=void 0,g=void 0;if(f=b[e+1],g=f.children&&f.children[0])return d.syncToProjectToc(a,g.children,c)})}}(this))}else if(c)return c(b)}},{key:"syncToTocItem",value:function(a,b,c){var d=void 0,e=void 0,f=void 0;return null==c&&(c=1),e=0,d=0,f=null,h.any(b,function(b){return function(g){var j=void 0,k=void 0,l=void 0,n=void 0,o=void 0;if(k=i.dataset(g,"childorder")||"",k===b.order&&(a.isBookNode(g)&&(j=g,f=j),j&&d++,b.bookNos[0]===d)){if(a.isPageNode(g)&&(n=g),n&&e++,1===b.bookNos.length)0===b.pageNo?(o=g,f&&a.openBook(f,!0,function(){return a.updateBookInfo()})):n&&e===b.pageNo&&(o=g),a.updateBookInfo(),o&&a.selectLink(o,!0,c);else if(f&&(l=i.hasClass(g,"child")))return b.bookNos.shift(),a.openBook(f,!0,function(){return h.defer(function(){var c=void 0;if(c=g.children&&g.children[0])return b.syncToTocItem(a,c.children,m)})}),!0;return null!=o}}}(this))}}]),a}();return a}(),o=function(){var a=void 0,b=void 0,c=void 0,o=void 0,p=void 0,q=void 0,r=void 0,s=void 0,t=void 0,u=void 0,v=void 0,w=void 0;c="expanded",a="active",b="collapsing",o="expanding",v="loading-book",w="selected",t="show_child",r="bookid",p="active_bookid",s="level",q="active_level",u=".p.toc";var x="curtoc",y="data-tocitem",z=k("KEY_TOC_BREADCRUMBS"),A=function(){function A(a){var b=this;e(this,A),this.widget=a,this.subscribeTopicID=d(this.subscribeTopicID,this),this.onClick=d(this.onClick,this),this.updateBookInfo=d(this.updateBookInfo,this),this._data={},this.projectAbsRef=[],null==this.syncToc&&(this.syncToc=new n),this.widget.publish(s,0),this.widget.publish(r,"_"),rh.model.subscribe(u,function(a){b.widget.publish(x,a),b.widget.publish("curlevel",0)}),this.widget.subscribe(k("KEY_TOC_SELECT_ITEM"),this.selectTocItem.bind(this)),j.subscribeOnce(k("EVT_PROJECT_LOADED"),function(a){return function(){return j.get(k("KEY_PUBLISH_MODE"))?a.getTOCData():a.loadToc(u,"",function(){return a.widget.publish(k("EVT_TOC_LOADED"),!0),a.widget.subscribe(rh.consts("KEY_TOPIC_ID"),a.subscribeTopicID)})}}(this))}return f(A,[{key:"expandBook",value:function(a,b,c,d){this.selectTocItem({id:b});var e=i.getAttribute(c,"data-itemkey");rh.model.publish("EVT_TOC_LOADEDgototab",{tab:0,key:e,item:d})}},{key:"updateBookInfo",value:function(){var a=void 0,b=void 0;if(a=this.widget.get(p),null!=a&&a!==this.widget.get(r)&&this.widget.publish(r,a),b=this.widget.get(q),null!=b&&b!==this.widget.get(s))return this.widget.publish(s,b)}},{key:"updateActiveBookInfo",value:function(a,b){return this.widget.publish(p,b),this.widget.publish(q,a)}},{key:"getText",value:function(a){return a.textContent.trim()}},{key:"_getPreviousItemNode",value:function(a){var b=this.pid(i.getAttribute(a,"data-itemid"));return i.find(this.widget.node,'[data-itemid="'+b+'"]')[0]}},{key:"updateBreadcrumbInfo",value:function(a){var b=a,c=void 0,d=[];if(this.isTOCItem(a)){for(d.push(this._createBreadcrumbItem(b));c=this._getPreviousItemNode(b);)d.push(this._createBreadcrumbItem(c)),b=c;d.reverse(),d.length>0&&(d[d.length-1].lastNode=!0),d.curlevel=this.widget.get("curlevel"),this.widget.publish(z,d)}}},{key:"_createBreadcrumbItem",value:function(a){var b=a;this.hasTOCItemLink(a)||(b=this._findFirstLink(a));var c=b&&(i.getAttribute(b,"href")||i.getAttribute(b,"link"))||"#";return{id:i.getAttribute(a,"data-itemid"),text:this.getText(a),url:c,hasUrl:this.hasTOCItemLink(a),lastNode:!1}}},{key:"isTOCItem",value:function(a){return"LI"===i.nodeName(a)||i.getAttribute(a,y)}},{key:"_findFirstLink",value:function(a){var b={that:this},c=g.parentNode(a);return b.bookid=i.getAttribute(a,"data-itemid"),i.traverseNode(c,this._findLinkFn,null,null,b),b.linkNode}},{key:"_isParentTocItem",value:function(a){return this.bookNode!==a&&this.that.isTOCItem(a)}},{key:"_findLinkFn",value:function(a){var b=i.getAttribute(a,"data-itemid");return b===this.bookid&&(this.bookFound=!0),!this.bookFound||!this.that.hasTOCItemLink(a)||void 0!==this.linkNode||(this.linkNode=a,!1)}},{key:"nextLevel",value:function(a){var b=void 0;return b=h.parseInt(i.dataset(a,"itemlevel"),0),i.hasClass(a,c)?b:b+1}},{key:"onClick",value:function(a){var b=void 0,c=void 0,d=void 0,e=void 0;if(e=a.currentTarget,b=a.target,c=this.hasLink(b),d=this.getItemNode(b,e),this.isBookNode(d)&&(c&&this.selectedNode!==d&&this.isOpenBook(d)||(this.toggleBook(d,!1),this.updateBreadcrumbInfo(d))),!(!c||this.isUrlNode(d)&&this.hasExternalLink(b)))return this.selectLink(d,!1)}},{key:"selectLink",value:function(a,b,c){if(null==c&&(c=m),this.selectedNode&&i.removeClass(this.selectedNode,w),b&&this.selectedNode!==a&&h.delay(function(){return a.scrollIntoView(!1)},c),this.selectedNode=a,a)return this.updateBreadcrumbInfo(a),i.addClass(a,w)}},{key:"selectTocItem",value:function(a){var b=a.id+"_0";if(b){for(var c={},d=-1;b;)d++,c[b]=!0,b=b.substr(0,b.lastIndexOf("_"));this.widget.publish("show_child",c),this.widget.publish("curlevel",d),a.url&&rh.model.publish("EVT_TOC_LOADEDgototab",{tab:0,item:{url:a.url}})}}},{key:"getItemNode",value:function(a,b){return h.findParentNode(a,b,this.isTOCItem)}},{key:"getChildItemNode",value:function(a,b){return i.find(a,function(a){return"LI"===i.nodeName(a)||i.getAttribute(a,y)})}},{key:"hasTOCItemLink",value:function(a){var b=i.getAttribute(a,"data-haslink");return"true"===b}},{key:"hasLink",value:function(a){var b=void 0;return b=i.getAttribute(a,"href"),b&&"#"!==b}},{key:"isBookNode",value:function(a){return i.hasClass(a,"book")}},{key:"isTopicNode",value:function(a){return i.hasClass(a,"item")}},{key:"isUrlNode",value:function(a){return i.hasClass(a,"url")}},{key:"isPageNode",value:function(a){return this.isTopicNode(a)||this.isUrlNode(a)}},{key:"isOpenBook",value:function(b){return this.widget.get(l)?i.hasClass(b,a):i.hasClass(b,c)}},{key:"hasExternalLink",value:function(a){var b=void 0;return b=i.getAttribute(a,"href"),!(!b||h.isRelativeUrl(b))&&!h.isUrlAllowdInIframe(b)}},{key:"getBookNode",value:function(a,b){var c=void 0;return c=this.getItemNode(a,b),this.isBookNode(c)?c:null}},{key:"animateCollapse",value:function(a){return h.each([a,a.nextElementSibling],function(a){return i.addClass(a,b),h.delay(function(){return i.removeClass(a,b)},m)})}},{key:"animateExpand",value:function(a){return h.each([a,a.nextElementSibling],function(a){return i.addClass(a,o),h.delay(function(){return i.removeClass(a,o)},m)})}},{key:"toggleBook",value:function(a,b){return null==b&&(b=!0),this.isOpenBook(a)?this.closeBook(a):this.openBook(a,b)}},{key:"closeBook",value:function(a){var b=void 0,d=void 0;if(b=i.dataset(a,"itemid"),d=""+t+b,!1!==this.widget.get(d)&&this.widget.publish(d,!1),this.updateActiveBookInfo(this.nextLevel(a),this.pid(b)),this.updateBookInfo(),i.hasClass(a,c))return i.removeClass(a,c),this.animateCollapse(a)}},{key:"openBook",value:function(a,b,d){var e=void 0,f=void 0,g=void 0,h=void 0;return null==d&&(d=this.updateBookInfo),g=i.dataset(a,"itemkey"),f=i.dataset(a,"itemid"),e=i.dataset(a,"childorder"),h=""+t+f,!0!==this.widget.get(h)&&this.widget.publish(h,!0),this.updateActiveBookInfo(this.nextLevel(a),f),this.widget.get(g)?(i.hasClass(a,c)||(i.addClass(a,c),this.animateExpand(a)),d()):(i.addClass(a,v),b&&a.scrollIntoView(!1),this.loadToc(g,e,function(b){return function(){return i.removeClass(a,v),i.addClass(a,c),b.animateExpand(a),d()}}(this)))}},{key:"extractTempData",value:function(){var a=void 0;return a=this.widget.get(rh.consts("KEY_TEMP_DATA")),this.widget.publish(rh.consts("KEY_TEMP_DATA")),a}},{key:"loadToc",value:function(a,b,c){var d=void 0,e=void 0,f=void 0,g=void 0;return g=this.parseKey(a),d=g.absRef,e=g.key,f=d?d+"/":"",h.loadScript(f+"whxdata/"+e+".new.js",!0,function(e){return function(){var f=void 0;return f=e.extractTempData()||[],h.each(f,function(a){if(a.absRef=d,b)return a.childOrder=b}),e.loadRefToc(f,e.childOrder(b),function(b){if(e.widget.publish(a,b),c)return c()})}}(this))}},{key:"loadRefToc",value:function(a,b,c){var d=void 0,e=void 0,f=void 0;return null==a&&(a=[]),e=h.findIndex(a,function(a){if(a.ref)return!0}),e!==-1?(f=a[e],d=f.absRef||"",d&&(d+="/"),d+=f.ref,h.loadScript(d+"/whxdata/toc.new.js",!0,function(f){return function(){var g=void 0;return g=f.extractTempData()||[],h.each(g,function(a){if(a.absRef=d,b)return a.childOrder=b}),Array.prototype.splice.apply(a,[e,1].concat(g)),f.loadRefToc(a,f.nextChildOrder(b),c)}}(this))):c?c(a):void 0}},{key:"getTOCData",value:function(){return j.subscribeOnce(k("KEY_PUBLISH_BASE_URL"),function(a){return function(){var b=void 0,c=void 0;try{return j.subscribe(k("KEY_PROJECT_LIST"),function(b){var c=void 0,d=void 0,e=void 0;return d=b.length,c=[],e="",h.each(b,function(a){return a=h.makeRelativeUrl(a,b[0]),a&&(a+="/"),h.loadScript(a+"whxdata/toc.new.js",!0,function(b){return function(){var f=void 0;if(d--,f=b.extractTempData()||[],c=c.concat(f),h.each(f,function(b){if(b.absRef=a,e)return b.childOrder=e}),e=e?b.nextChildOrder(e):b.childOrder(e),0===d)return b.widget.publish(".p.toc",c),b.widget.publish(k("EVT_TOC_LOADED"),!0),b.widget.subscribe(rh.consts("KEY_TOPIC_ID"),b.subscribeTopicID)}}(this))},a)})}catch(c){if(b=c,rh._debug)return rh._d("warn",b.message)}}}(this))}},{key:"nextChildOrder",value:function(a){var b=void 0;return b=a.split("@"),b[b.length-1]=1+h.parseInt(b[b.length-1],0),b.join("@")}},{key:"childOrder",value:function(a){return a?a+"@1":"@1"}},{key:"pid",value:function(a){var b=void 0;return b=a.split("_"),b.pop(),b.join("_")||"_"}},{key:"key",value:function(a,b){var c=void 0;return null==a&&(a=""),c=h.findIndex(this.projectAbsRef,function(b){return b===a}),c===-1&&(c=this.projectAbsRef.length,this.projectAbsRef.push(a)),".p.child_toc."+c+"."+b}},{key:"parseKey",value:function(a){var b=void 0,c=void 0,d=void 0;return a=a.substring(3),c=a.split("."),d=c.pop(),b=this.projectAbsRef[c.pop()]||"",{key:d,absRef:b}}},{key:"url",value:function B(a,b){var c=void 0,d=void 0,e=void 0,f=void 0,B=void 0;return a.url?(f=a.absRef?h.ensureSlash(a.absRef):"",B=""+f+a.url,c=h.extractHashString(B),c.length>0&&(c="#"+c,d=h.filePath(B),e=h.extractParamString(B),e.length>0&&(e+="&"),e="?"+e+"rhtocid="+b,B=""+d+e+c),encodeURI(B)):"#"}},{key:"tags",value:function(a){var b=void 0;return b=a.absRef?"+"+a.absRef:"",a["data-rhtags"]?a["data-rhtags"]+b:""}},{key:"subscribeTopicID",value:function(a){var b=void 0,c=void 0;return null==a&&(a={}),(c=h.hashParams().rhtocid)?(b=this.getPathfromId(c),void this.selectTocById(b,this.widget.node)):this.syncToc.sync(this,a)}},{key:"subscribeBookId",value:function(a){var b=void 0,c=void 0;if(a)return c=this.getPathfromId(a),this.selectTocById(c,this.widget.node,null,b)}},{key:"getPathfromId",value:function(a){var b=void 0;return b=a.split("_"),b.shift(),b=h.map(b,function(a){return h.parseInt(a,0)})}},{key:"selectTocById",value:function(a,b,c,d){var e=void 0,f=void 0;if(null==c&&(c=1),b&&b.children&&(f=a.shift(),e=h.find(b.children,function(a){if(this.isBookNode(a)||this.isPageNode(a)){if(0===f)return!0;f--}return!1},this)))return 0===a.length&&this.selectLink(e,!0,c),this.isBookNode(e)?this.openBook(e,!0,function(b){return function(){return h.defer(function(){var c=void 0,d=void 0;return 0===a.length?b.updateBookInfo():(c=e.nextElementSibling,d=c.children&&c.children[0],b.selectTocById(a,d,m))})}}(this)):this.updateBookInfo()}}]),A}();return A.prototype["class"]=function(a){return"remoteitem"===a.type?"url":a.type},A}(),rh.controller("TocController",o)},{"../../src/lib/rh":3,"../../src/responsive_help/utils/node_utils":30}],3:[function(b,c,d){(function(a){c.exports=a.rh}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof a?a:{})},{}],4:[function(a,b,c){a("../lib/rh"),a("./layout/ui/carousel"),a("./layout/home_controller"),a("../../lenient_src/layout/search_util"),a("./layout/search/search_controller"),a("./layout/favorites_controller"),a("./layout/toc_breadcrumbs_controller.js"),a("../../lenient_src/layout/toc_controller"),a("./layout/rh2017layoutcontroller"),a("./layout/modal_dialog"),a("./layout/search_result_controller.js")},{"../../lenient_src/layout/search_util":1,"../../lenient_src/layout/toc_controller":2,"../lib/rh":3,"./layout/favorites_controller":5,"./layout/home_controller":6,"./layout/modal_dialog":7,"./layout/rh2017layoutcontroller":8,"./layout/search/search_controller":23,"./layout/search_result_controller.js":27,"./layout/toc_breadcrumbs_controller.js":28,"./layout/ui/carousel":29}],5:[function(a,c,d){var rh=a("../../lib/rh"),g=rh.consts,h=function(){function a(b){var c=this;e(this,a),this.widget=b,this._loadFromStorage=!1,this._favMemoryStore=void 0,rh.model.subscribeOnce(g("EVT_PROJECT_LOADED"),function(){c.init()})}return f(a,[{key:"_getUniqueId",value:function(){function a(a){var b=(Math.random().toString(16)+"000000000").substr(2,8);return a?"-"+b.substr(0,4)+"-"+b.substr(4,4):b}return a()+a(!0)+a(!0)+a()}},{key:"numberOfItems",value:function(a){return Object.keys(a).length}},{key:"_getFavHTMLElements",value:function(a){for(var c=b.getElementsByTagName("div"),d=[],e=0;e<c.length;e++)c[e].getAttribute(rh.consts("FAVATTRIBUTE"))===a&&d.push(c[e]);return d}},{key:"getLinkTitle",value:function(){return rh.model.get(g("TOPIC_FAVORITE"))?g("KEY_LNG").unsetAsFavorite:g("KEY_LNG").setAsFavorite}},{key:"_loadFavoritesFromStorage",value:function(){var a=void 0,b=rh.storage.fetch(g("FAVSTORAGE"));return a="undefined"==typeof b||null===b?{}:JSON.parse(b)}},{key:"_loadFavorites",value:function(){return this._loadFromStorage===!1&&(this._favMemoryStore=this._loadFavoritesFromStorage()),this._favMemoryStore}},{key:"_saveFavorites",value:function(){var a=void 0;a=JSON.stringify(this._favMemoryStore),rh.storage.persist(rh.consts("FAVSTORAGE"),a)}},{key:"_unFavoriteTopic",value:function(a){for(var b in this._favMemoryStore){var c=this._favMemoryStore[b];if(c.topic===a){delete this._favMemoryStore[b];break}}this._saveFavorites(),rh.model.publish(rh.consts("EVENTFAVCHANGE"),null)}},{key:"_favoriteTopic",value:function(a,b){this._favMemoryStore[this._getUniqueId()]={topic:a,title:b},this._saveFavorites(),rh.model.publish(rh.consts("EVENTFAVCHANGE"),null)}},{key:"getStorageId",value:function(){return"fav-"+rh._.getHostFolder()}},{key:"getTopicURL",value:function(){return rh.model.get(rh.consts("KEY_TOPIC_URL"))}},{key:"getTopicTitle",value:function(){return rh.model.get(rh.consts("KEY_TOPIC_TITLE"))}},{key:"isTopicFavorite",value:function(a){var b=void 0,c=void 0;a||(a=this.getTopicURL()),b=this._loadFavorites(),c=!1;for(var d in b){var e=b[d];if(e.topic===a){c=!0;break}}return c}},{key:"setTopicFavoriteState",value:function(){rh.model.publish(g("TOPIC_FAVORITE"),this.isTopicFavorite())}},{key:"setFavoritesList",value:function(){var a=[],b=void 0,c=this._loadFavorites();for(b in c)a.push(c[b]);rh.model.publish(g("KEY_FAVORITES"),a)}},{key:"toggleFavorite",value:function(a){a||(a=this.getTopicURL()),this.isTopicFavorite(a)?this._unFavoriteTopic(a):this._favoriteTopic(a,this.getTopicTitle()),this.setTopicFavoriteState()}},{key:"init",value:function(){rh.storage.init(this.getStorageId()),rh.model.subscribe(rh.consts("KEY_TOPIC_URL"),this.setTopicFavoriteState.bind(this)),rh.model.subscribe(rh.consts("EVENTFAVCHANGE"),this.setFavoritesList.bind(this)),this.setFavoritesList(),rh.model.publish(g("TOPIC_FAVORITE"),this.isTopicFavorite())}}]),a}();rh.controller("FavoritesController",h)},{"../../lib/rh":3}],6:[function(a,b,c){var rh=a("../../lib/rh"),d=rh._,g=function(){function a(b){e(this,a),this.widget=b}return f(a,[{key:"goToHome",value:function(a){var b=void 0;void 0!==a&&""!==a&&(b={rhtocid:a}),d.goToHome(b)}}]),a}();rh.controller("HomeController",g)},{"../../lib/rh":3}],7:[function(a,c,d){var rh=a("../../lib/rh"),g=a("../utils/node_utils"),h=rh.$,i=function(){function a(){e(this,a)}return f(a,[{key:"createChildWidget",value:function(){this.node=h.createElement("div",this.template),g.appendChild(b.body,this.node),this.widget=new rh.Widget({node:this.node}),this.widget.init()}},{key:"ShowModal",value:function(a){this.createChildWidget(),this.widget.subscribe("close",this._close.bind(this)),this.widget.publish("content",a.content)}},{key:"_close",value:function(){this.widget.destruct(),this.widget=void 0,g.removeChild(this.node),this.node=void 0}},{key:"template",get:function(){return'\n    <div class="rh-modal">\n      <div>\n        <div class ="rh-modal-header">\n          <div class ="rh-modal-close" data-click="@close(true)">\n          </div>\n        </div>\n        <div class="rh-modal-body" >\n          <div class="rh-modal-content" data-html="content">\n          </div>\n        </div>\n      </div>\n    </div>'}}]),a}();rh.model.csubscribe("SHOW_MODAL",function(a){var b=new i;b.ShowModal(a)})},{"../../lib/rh":3,"../utils/node_utils":30}],8:[function(a,c,g){var rh=a("../../lib/rh"),h=rh.$,i=rh._,j=rh.consts,k=function(){function a(b){e(this,a),this.widget=b,this.topicFrame=".topic-container iframe",this.initLayout(),this.initModal()}return f(a,[{key:"isLayoutMode",value:function(a){var b=a||i.hashParams(),c=b[rh.consts("HASH_KEY_TOPIC")];return b[rh.consts("HASH_KEY_UIMODE")]!==j("HELP_SEARCH_MODE")&&(!c||"true"===b[rh.consts("HASH_HOMEPAGE_MODE")]||b[rh.consts("HASH_KEY_RH_TOCID")])}},{key:"initLayout",value:function(){var a=this;rh.model.subscribe(j("EVT_HASH_CHANGE"),function(b){var c=b.newMap,e=b.oldMap;a.isLayoutMode()?a.widget.publish(rh.consts("KEY_VIEW_MODE"),rh.consts("HELP_LAYOUT_MODE")):"search"===c[rh.consts("HASH_KEY_UIMODE")]?(a.widget.publish(rh.consts("KEY_VIEW_MODE"),rh.consts("HELP_SEARCH_MODE")),i.queueUpdateHashMap(d({},j("HASH_HOMEPAGE_MODE"),!1),!1)):a.widget.publish(rh.consts("KEY_VIEW_MODE"),rh.consts("HELP_TOPIC_MODE")),e[rh.consts("HASH_KEY_TOPIC")]&&!c[rh.consts("HASH_KEY_RH_TOCID")]&&e[rh.consts("HASH_KEY_TOPIC")]!==c[rh.consts("HASH_KEY_TOPIC")]&&"true"===c[rh.consts("HASH_HOMEPAGE_MODE")]&&e[rh.consts("HASH_HOMEPAGE_MODE")]===c[rh.consts("HASH_HOMEPAGE_MODE")]&&i.queueUpdateHashMap(d({},j("HASH_HOMEPAGE_MODE"),"false"),!1)}),rh.model.subscribe(rh.consts("EVT_NAVIGATE_TO_URL"),function(){var b=rh.$.find(a.topicFrame)[0];b.style.height=""}),rh.model.subscribe(rh.consts("KEY_TOPIC_HEIGHT"),function(b){var c=rh.$.find(a.topicFrame)[0];c.style.height=parseFloat(b)+30+"px"});var b=i.hashParams();this.isLayoutMode()&&"true"!==b[rh.consts("HASH_HOMEPAGE_MODE")]&&i.queueUpdateHashMap(d({},j("HASH_HOMEPAGE_MODE"),!0),!1),rh.model.subscribe("EVT_TOC_LOADEDgototab",function(b){b.key&&rh.model.subscribe(b.key,function(a,c,d){d(),b.item&&b.item.url&&!a[0].added&&(a.unshift({type:"item",url:b.item.url,name:b.item.name,added:!0}),rh.model.publish(b.key,a))}),b.item.url&&a.viewTopicInLayoutMode(b.item.url)})}},{key:"viewTopicInLayoutMode",value:function(a){var b=d({homepage:"true"},rh.consts("HASH_KEY_RH_TOCID"),!0);a&&"#"!==a&&(b.t=a),i.queueUpdateHashMap(b,!1)}},{key:"initModal",value:function(){b.addEventListener("keydown",function(a){27===a.keyCode&&rh._.each(h.find(".modal"),function(a){h.addClass(a,"rh-hide")})},!1)}}]),a}();rh.controller("RH2017LayoutController",k)},{"../../lib/rh":3}],9:[function(a,b,c){var d={minPreviousThreshold:.2,previousnGram:1,max_predictions:5,PREDICTOR_SOURCE_ID:{HISTORY_PREDICTOR:0,NGRAM_PREDICTOR:1,GENERAL_PREDICTOR:2,CORRECTOR:3}};b.exports=d},{}],10:[function(a,b,c){var d=a("./loader"),g=a("./indices"),rh=a("../../../lib/rh"),h=rh._,i=a("./prediction"),j=a("./consts"),k=a("./utils"),l=a("./prediction_list"),m=function(){function a(b){var c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;e(this,a),this._parsed_input=b,this.predictions=[],this.max_predictions=c}return f(a,[{key:"getCorrections",value:function(a){this._callback=a,this._computePredictions();var b=d.getHashes(this._parsed_input._partial);if(b)for(var c=b.length,e=0;e<c&&this.predictions.length<this.max_predictions;e++){var f=b[e];this._addCorrection(f)}this.onResultCalculated()}},{key:"clear",value:function(){this.predictions=[]}},{key:"_computePredictions",value:function(){var a=d.getHashes(this._parsed_input._partial);a&&this._addCorrection(a)}},{key:"onResultCalculated",value:function(){this._callback&&this._callback(new l(this.predictions,this._parsed_input))}},{key:"_matchCorrection",value:function(a){return this._hamming_dist=this._getDistance(a),this._hamming_dist<=2&&!d.isStopWord(a)}},{key:"_addCorrection",value:function(a){if(a){var b=k.getSafeElement(a,g.MAP.WORD);if(b&&this._matchCorrection(b)){var c=this._parsed_input.replaceLastWord(b),d=this._parsed_input.completeSuggestion(c),e=new i(d,1/this._hamming_dist,2,j.PREDICTOR_SOURCE_ID.CORRECTOR);this.predictions.push(e)}}}},{key:"_getDistance",value:function(a){return h.findEditDist(this._parsed_input._partial,a)}}]),a}();b.exports=m},{"../../../lib/rh":3,"./consts":9,"./indices":15,"./loader":17,"./prediction":20,"./prediction_list":22,"./utils":26}],11:[function(a,b,c){var d=function(){function a(b){e(this,a),this._callback=b,this._count=0}return f(a,[{key:"signal",value:function(){this._count++,this._count>=0&&this._callback&&this._callback()}},{key:"wait",value:function(a){var b=a||1;this._count-=b}}]),a}();b.exports=d},{}],12:[function(a,b,c){var d=a("./loader"),g=a("./prediction_list"),h=a("./prediction_creator"),i=a("./consts"),j=a("./indices"),rh=a("../../../lib/rh"),k=rh._,l=a("./merger"),m=function(){function a(b){var c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;e(this,a),this._max_predictions=c,this.total_count=d.getTotalCount(),this._callback=b,this._source=i.PREDICTOR_SOURCE_ID.GENERAL_PREDICTOR,this.prediction_merger=new l([],5*this.total_count)}return f(a,[{key:"clear",value:function(){this.prediction_merger.clear(),this.parsed_input=void 0}},{key:"getPredictions",value:function(a){this._init(a),this._computePredictions(),this._onResultComputed()}},{key:"_computePredictions",value:function(){var a=this._getWordHashes();a&&this._addPredictions(a)}},{key:"_isWholeWordInput",value:function(){return this.parsed_input.isWholeWord}},{key:"_getWordHashes",value:function(){return this.parsed_input.isWholeWord?d.top_words:d.getHashes(this.parsed_input._partial)}},{key:"_init",value:function(a){this.prediction_merger=new l([],5*this.total_count),this.parsed_input=a}},{key:"_onResultComputed",value:function(){this._callback&&this._callback(new g(this.predictions,this.parsed_input))}},{key:"_addPredictions",value:function(a){if(a)for(var b=a.length,c=0;c<b&&this.predictions.length<this.max_predictions;c++){var d=a[c];this._addWordPrediction(d)}}},{key:"_addWordPrediction",value:function(a,b){b=b||this._matches_partially.bind(this);var c=d.getModelData(a),e=d.total_count;if(b(a)){var f=a[j.MAP.WORD];this._should_add_prediction(f)&&this._create_predictions(a,e,c)}}},{key:"_continueFn",value:function(){return!0}},{key:"_should_add_prediction",value:function(a){return!d.isStopWord(a)&&!this.parsed_input.equalLastWord(a)}},{key:"_matches_partially",value:function(a){if(this.parsed_input.isWholeWord)return!0;var b=a[j.MAP.WORD];return this.parsed_input.comparePartial(b)}},{key:"_create_predictions",value:function(a,b,c){var d=this,e=new h(c,b,this.parsed_input,this._continueFn),f=e.getMultiPredictions(a,!0,void 0,this._source);k.each(f,function(a){void 0!==a&&d.prediction_merger.mergePrediction(a)})}},{key:"_calculate_probability",value:function(a){return a/this.total_count}},{key:"predictions",get:function(){return this.prediction_merger.predictions}},{key:"max_predictions",set:function(a){this._max_predictions=a},get:function(){return this._max_predictions}}]),a}();b.exports=m},{"../../../lib/rh":3,"./consts":9,"./indices":15,"./loader":17,"./merger":18,"./prediction_creator":21,"./prediction_list":22}],13:[function(a,b,c){var rh=a("../../../lib/rh"),d=rh._,g=a("./prediction"),h=a("./input_parser"),i=a("./prediction_list"),j=a("./consts"),k=function(){function a(b,c){e(this,a),this._reader=b,this._predictions=[],this._callback=c,this._source=j.PREDICTOR_SOURCE_ID.HISTORY_PREDICTOR,this._max_predictions=void 0===j._max_history_predictions?2:j._max_history_predictions}return f(a,[{key:"getPredictions",value:function(a){return this._predictions=[],this._parsed_input=a,this._computePredictions(),this._callback&&this._callback(new i(this._predictions,this._parsed_input)),this._predictions}},{key:"init",value:function(){}},{key:"clear",value:function(){this._predictions=[]}},{key:"_computePredictions",value:function(){var a=this;""!==this._parsed_input.trimmedText&&(d.each(this._reader._list,function(b){a._match(b.text)&&a._predictions.push(a._createPrediction(b))}),this._purge())}},{key:"_purge",value:function(){this._predictions.splice(this._max_predictions)}},{key:"_createPrediction",value:function(a){var b=new g(a.text,1,a.count,this._source);return b}},{key:"_match",value:function(a){if(this._parsed_input.original_text.length>a.length)return!1;var b=new h(a,(!0));return this._parsed_input.compare(b)}}]),a}();b.exports=k},{"../../../lib/rh":3,"./consts":9,"./input_parser":16,"./prediction":20,"./prediction_list":22}],14:[function(a,b,c){var rh=a("../../../lib/rh"),d=rh._,g=a("./utils"),h=function(){function a(){e(this,a)}return f(a,[{key:"initHistory",value:function(a){void 0===this._list&&(this._list=a||[])}},{key:"getHistory",value:function(){return this._list||[]}},{key:"_updateText",value:function(a,b){this.getHistory().splice(b,1),this.getHistory().unshift(a)}},{key:"_addNewText",value:function(a){this.getHistory().push(a)}},{key:"add",value:function(a){var b=d.findIndex(this.getHistory(),function(b){return 0===g.compareNoCase(a.text,b.text)});b>=0?this._updateText(a,b):this._addNewText(a)}},{key:"delete",value:function(a){var b=d.findIndex(this.getHistory(),function(b){return 0===g.compareNoCase(a,b.text)});b>=0&&this.getHistory().splice(b)}}]),a}();b.exports=new h},{"../../../lib/rh":3,"./utils":26}],15:[function(a,b,c){var d={MAP:{WORD:0,HASH:1,COUNT:2,MODEL_FILE_NO:3,MODEL_INDEX:4,TOPICS:5},MODEL:{WORD_HASH:0,COUNT:1,NEXT_MODEL:2},FIRST_PREDICTION:{NEXT:0,PREVIOUS:1}};b.exports=d},{}],16:[function(a,b,c){var d=a("./utils"),rh=a("../../../../src/lib/rh"),g=rh._,h=function(){function a(b,c,d,f){e(this,a),this.isPrevious=f,this.selection=void 0===d?b.length:d;var g=this._calculateSeparator(b);this.isPrevious||(this.isWholeWord=c||this._isWholeWord(b,g)),this.initText(b,g)}return f(a,[{key:"initText",value:function(a,b){this._computeText(a,b),this.trimmedText=this.original_text.trim(),this.words=g.compact(this.trimmedText.split(" ")||[]),this._reverseIfPrevious(),!this.isWholeWord&&this.words.length>0&&(this._partial=this.words.splice(-1)[0])}},{key:"_computeText",value:function(a,b){this._right_text="",this._left_text="",void 0===b&&(b=a.length),this.isSplitText=!(0===b||b===a.length);var c=a.substring(0,b),d=a.substring(b);this.isPrevious?(this.original_text=d,this._left_text=c.trim()):(this.original_text=c,this._right_text=d.trim())}},{key:"equalRemaingWord",value:function(a){if(""!==this._left_text||""!==this._right_text){var b=this._getRemainigWord();if(b)return 0===d.compareNoCase(b,a)}return!1}},{key:"_getRemainigWord",value:function(){var a=this.isPrevious?this._left_text.split(" "):this._right_text.split(" ");if(a=a||[],a=g.compact(a),a.length>0)return this.isPrevious?a[a.length-1]:a[0]}},{key:"completeSuggestion",value:function(a){return this.isPrevious?0===this._left_text.length?a:this._left_text+" "+a:0===this._right_text.length?a:a+" "+this._right_text}},{key:"_calculateSeparator",value:function(a){if(this.isPrevious){if(0===this.selection)return this.isWholeWord=!0,0;if(a.length>this.selection&&" "!==a[this.selection-1]){var b=a.lastIndexOf(" ",this.selection-1);return this.isWholeWord=!1,b>=0?b+1:0}this.isWholeWord=!0}return this.selection}},{key:"_reverseIfPrevious",value:function(){this.isPrevious&&this.words.reverse()}},{key:"_isWholeWord",value:function(a,b){return this.isPrevious?0===b||a.length>b&&" "===a[b-1]:b>0&&" "===a[b-1]}},{key:"compare",value:function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;if(c=void 0===c?this.words.length-1:c,this.words.length>a.words.length)return!1;for(var e=b;e<=c;e++){var f=this.words[e],g=a.words[e];if(0!==d.compareNoCase(f,g))return!1}return this.matchPartial(a,e)}},{key:"matchPartial",value:function(a,b){if(void 0===this._partial)return!0;if(a.words.length<=b)return!1;var c=a.words[b];return this.comparePartial(c)}},{key:"comparePartial",value:function(a){return this._matchExp=new RegExp("^"+this._partial,"i"),this._matchExp.test(a)}},{key:"completeWord",value:function(a){return this.isWholeWord||void 0===this._partial||0===this._partial.length?this.getTermForCompleteWord(a,this.trimmedText):this.getTermForPartialText(a)}},{key:"getTermForPartialText",value:function(a){var b=a.substring(this._partial.length,a.length);if(this.isPrevious){var c="",d=this.trimmedText.indexOf(" ");return d>=0&&(c=this.trimmedText.substring(d)),this._partial+b+c}return this.trimmedText+b}},{key:"getTermForCompleteWord",value:function(a){return this.isPrevious?a+" "+this.trimmedText:this.trimmedText+" "+a}},{key:"replaceLastWord",value:function(a){var b=this.trimmedText;if(void 0!==this._partial&&!this.isWholeWord){var c=this.trimmedText.length-this._partial.length;b=this.trimmedText.substring(0,c),b=b.trim()}return b+" "+a}},{key:"equalLastWord",value:function(a){if(0===this.words.length)return!1;var b=this.words[this.words.length-1];return 0===d.compareNoCase(b,a)}}]),a}();b.exports=h},{"../../../../src/lib/rh":3,"./utils":26}],17:[function(a,b,c){var d=this,rh=a("../../../lib/rh"),g=rh._,h=rh.model,i=rh.consts,j=a("./utils"),k=a("./indices"),l=a("./consts"),m=function(a){return i("SEARCH_MODEL_ADDR")+a.toString()+".js"},n=function(a){return i("SEARCH_MODEL_KEY")+a.toString()},o=function(){return i("SEARCH_MAP_ADDR")},p=function(){return void 0!==d.index_data},q=function(){function a(){e(this,a)}return f(a,[{key:"init",value:function(a){this.loadIndex(a),this.loadMap(a)}},{key:"getModelCount",value:function(){return this.index_data.Model.length}},{key:"getMapHash",value:function(a){return this._hash_to_word[a]}},{key:"getHashes",value:function(a){if(void 0!==a&&a.length>0)return this.getAplhabetHashes(a[0])}},{key:"getAplhabetHashes",value:function(a){if(this.map_data&&1===a.length){var b=a.toLowerCase();return this.map_data[b]}}},{key:"getWordModel",value:function(a,b){var c=void 0,d=this._getHashForWord(a);return d&&b&&(c=b[d[k.MAP.MODEL_INDEX]]),c}},{key:"getCount",value:function(a){var b=this._getHashForWord(a);if(b)return b[k.MAP.COUNT]}},{key:"getModelData",value:function(a){var b=a[k.MAP.MODEL_FILE_NO],c=a[k.MAP.MODEL_INDEX],d=h.get(n(b));return d||this.loadModel(b),d&&d[c]}},{key:"_compareWordCount",value:function(a,b){var c=j.getSafeElement(a,k.MAP.COUNT),d=j.getSafeElement(b,k.MAP.COUNT);return c&&d?d-c:0}},{key:"_buildTopWords",value:function(a){a.sort(this._compareWordCount),a.splice(100*l.max_predictions),this._top_words=a}},{key:"getModelFileNo",value:function(a){var b=this._getHashForWord(a);if(b)return b[k.MAP.MODEL_FILE_NO]}},{key:"_getHashForWord",value:function(a){var b=void 0,c=this.getHashKey(a);return c&&(b=this._hash_to_word[c]),b}},{key:"getHashKey",value:function(a){if(a&&a.length>0){
var b=a.toLowerCase();return this._word_hash[b]}}},{key:"loadIndex",value:function(a){var b=this;p()===!1?g.loadScript(i("SEARCH_INDEX_FILE"),!0,function(){b.index_data=g.exports(),b.onIndexLoaded(a)},!0):this.onIndexLoaded(a)}},{key:"loadModel",value:function(a,b){var c=[];if(void 0!==a){var d=n(a),e=h.get(d);void 0===e?(h.publish(d,null),g.loadScript(m(a),!0,this.getOnModelLoadFn(a,b),!0)):null===e&&void 0!==b?h.subscribe(d,b):this.doCallback(b,e,a)}else this.doCallback(b,c,a)}},{key:"doCallback",value:function(a,b,c){a&&a(b,c)}},{key:"getOnModelLoadFn",value:function(a,b){return function(){var c=g.exports();h.publish(n(a),c),b&&b(c,a)}}},{key:"onMapLoaded",value:function(a){this.parseMap(),this.index_data&&a&&a()}},{key:"onIndexLoaded",value:function(a){this.map_data&&a&&a()}},{key:"parseMap",value:function(){var a=this.map_data;this._word_hash={},this._hash_to_word={};var b=[];for(var c in a){var d=a[c];this._parseWordsData(d),b=b.concat(d)}this._buildTopWords(b)}},{key:"_parseWordsData",value:function(a){var b=this;g.each(a,function(a){var c=parseInt(a[k.MAP.HASH]),d=a[k.MAP.WORD].toString();b._word_hash[d]=c,b._hash_to_word[c]=a})}},{key:"isStopWord",value:function(a){var b=g.find(this.index_data.stopWords,function(b){return 0===j.compareNoCase(a,b)});return void 0!==b}},{key:"getTotalCount",value:function(){return this.index_data.totalCount}},{key:"wordHashfromIndexKey",value:function(a,b){return g.find(this._hash_to_word,function(c){return c[k.MAP.MODEL_INDEX]===a&&c[k.MAP.MODEL_FILE_NO]===b})}},{key:"loadMap",value:function(a){var b=this;void 0===this.map_data?g.loadScript(o(),!0,function(){b.map_data=g.exports(),b.onMapLoaded(a)},!0):this.onMapLoaded(a)}},{key:"top_words",get:function(){return this._top_words}},{key:"nGram",get:function(){return this.index_data.nGram}},{key:"search_model",get:function(){return this.index_data.Model}},{key:"search_map",get:function(){return this.index_data.Map}},{key:"total_count",get:function(){return this.index_data.totalCount}},{key:"stop_words",get:function(){return this.index_data.stopWords}}]),a}();b.exports=new q},{"../../../lib/rh":3,"./consts":9,"./indices":15,"./utils":26}],18:[function(a,b,c){var rh=a("../../../lib/rh"),d=rh._,g=a("./utils"),h=function(){function a(b){var c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;e(this,a),this._predictions=b,this._max_predictions=c}return f(a,[{key:"merge",value:function(a){var b=this;d.each(a,function(a){b.mergePrediction(a)}),this._sort(),this._purge()}},{key:"clear",value:function(){this._predictions=[]}},{key:"_purge",value:function(){this._predictions.length>this._max_predictions&&this._predictions.splice(this._max_predictions)}},{key:"mergePrediction",value:function(a){var b=this.find_prediction(a.term);b?this.merge_item(b,a):this._predictions.push(a)}},{key:"_sort",value:function(){this.predictions.sort(this.compare_predictions)}},{key:"compare_predictions",value:function(a,b){return b.probability-a.probability}},{key:"find_prediction",value:function(a){return d.find(this._predictions,function(b){return 0===g.compareNoCase(b.term,a)})}},{key:"merge_item",value:function(a,b){a.probability+=b.probability,a.count=Math.max(a.count,b.count)}},{key:"predictions",get:function(){return this._predictions}}]),a}();b.exports=h},{"../../../lib/rh":3,"./utils":26}],19:[function(a,b,c){var rh=a("../../../lib/rh"),d=rh._,g=a("./loader"),h=a("./prediction_creator"),i=a("./prediction_list"),j=a("./consts"),k=a("./indices"),l=function(){function a(b,c,d){var f=arguments.length>3&&void 0!==arguments[3]?arguments[3]:20;e(this,a),this.level=b,this.previous=d,this._max_predictions=f,this.predictions=[],this._callback=c,this._source=j.PREDICTOR_SOURCE_ID.NGRAM_PREDICTOR}return f(a,[{key:"init",value:function(){}},{key:"clear",value:function(){this._word_model=void 0,this._prediction_array=void 0,this.parsed_input=void 0,this.predictions=[]}},{key:"getPredictions",value:function(a){this.parsed_input=a,this.predictions=[],void 0!==a&&a.words.length>=this.level?(this.word_index=a.words.length-this.level,this._word=a.words[this.word_index],this._loadInputModel(this._word,this._compute_word_predictions.bind(this))):this._onResultsComputed()}},{key:"_compute_word_predictions",value:function(a){this.predictions=[];var b=this.level,c=this._word,d=g.getCount(c);this._word_model=g.getWordModel(c,a),this._word_model&&(this._prediction_array=this._get_prediction_array(),this._compute_prediction_from_model(c,b,d)),this._onResultsComputed()}},{key:"_onResultsComputed",value:function(){this._callback&&this._callback(new i(this.predictions,this.parsed_input))}},{key:"_compute_prediction_from_model",value:function(a,b,c){if(void 0!==this._prediction_array)if(this._is_my_level(b))this._compute_next_words(c);else{b--;var d=this._get_word_index(b),e=this.parsed_input.words[d],f=g.getHashKey(e),h=this._get_next_model(this._prediction_array,f);h&&(c=h[k.MODEL.COUNT],this._prediction_array=h[k.MODEL.NEXT_MODEL],this._compute_prediction_from_model(e,b,c))}}},{key:"_get_next_model",value:function(a,b){if(b){var c=d.find(a,function(a){return a.length>1&&a[k.MODEL.WORD_HASH]===b});return c&&c.length>k.MODEL.NEXT_MODEL&&Array.isArray(c)?c:void 0}}},{key:"_get_word_index",value:function(a){return this.parsed_input.words.length-a}},{key:"_is_my_level",value:function(a){return 1===a}},{key:"_continueFn",value:function(){return!0}},{key:"_compute_next_words",value:function(a){var b=this._prediction_array;if(b&&b.length>0)for(var c=0;this.predictions.length<this.max_predictions&&c<b.length&&b[c].length>1;c++)if(this._matches_partially(b[c])){var d=this._create_predictions(b[c],a);this._compute_next_multi_words(d)}}},{key:"_compute_next_multi_words",value:function(a){var b=this;d.each(a,function(a){void 0!==a&&b.predictions.push(a)})}},{key:"_get_word_hash",value:function(a){return g.getMapHash(a[k.MODEL.WORD_HASH])}},{key:"_matches_partially",value:function(a){if(this.parsed_input.isWholeWord)return!0;var b=g.getMapHash(a[k.MODEL.WORD_HASH]);if(!b)return!1;var c=b[k.MAP.WORD];return this.parsed_input.comparePartial(c)}},{key:"_create_predictions",value:function(a,b){var c=new h(a,b,this.parsed_input,this._continueFn);return c.getMultiPredictions(void 0,void 0,void 0,this._source)}},{key:"_get_prediction_array",value:function(){return this.parsed_input.isPrevious&&this._word_model.length>1?this._word_model[1]:this._word_model[0]}},{key:"_loadInputModel",value:function(a,b){var c=this._findFileIndex(a);g.loadModel(c,b)}},{key:"_findFileIndex",value:function(a){return g.getModelFileNo(a)}},{key:"max_predictions",set:function(a){this.max_predictions=a},get:function(){return this._max_predictions}}]),a}();b.exports=l},{"../../../lib/rh":3,"./consts":9,"./indices":15,"./loader":17,"./prediction_creator":21,"./prediction_list":22}],20:[function(a,b,c){var d=function f(a,b,c,d){e(this,f),this.probability=b,this.term=a,this.count=c,this.source=d};b.exports=d},{}],21:[function(a,b,c){var d=a("./loader"),g=a("./prediction"),h=a("./utils"),i=a("./indices"),j=a("./input_parser"),k=a("./consts"),l=function(){function a(b,c,d,f){e(this,a),this._model_item=b,this.parsed_input=d||new j(""),this._init(),this._total_count=c,this._continueFn=f||this._isStopWord,this._nextModelFn=this._nextModel,this._predictions=[],this._multi_prediction=!1}return f(a,[{key:"_init",value:function(){this.term="",this.probability=1,this._first_word=!0,this.isFirstLevel=!1,this._level=0}},{key:"getPrediction",value:function(a,b,c,d){return this.word_hash=a,this.isFirstLevel=b,this.previous=c,this.source=d,this.isFirstLevel&&this._appendPreviousPredictions(this._model_item),this._appendPrediction(this._model_item,a),this._createPrediction()}},{key:"getMultiPredictions",value:function(a,b,c,d){return this._multi_prediction=!0,this.word_hash=a,this.isFirstLevel=b,this.previous=c,this.source=d,this.isFirstLevel&&this._appendPreviousPredictions(this._model_item),this._appendPrediction(this._model_item,a),this._predictions}},{key:"equalRemaingWord",value:function(a){var b=this._getword(a,this.word_hash);return!(!b||!this.parsed_input.equalRemaingWord(b))}},{key:"_appendPreviousPredictions",value:function(a){var b=this._getPreviousItem(a);if(b){var c=this._getPreviousProbability(b);c>k.minPreviousThreshold&&this._appendPreviousTerm(b)}}},{key:"_getPreviousItem",value:function(a){var b=h.getFirstLevelNextModel(a,!0);if(b){var c=h.getSafeElement(b,0);return c}}},{key:"_appendPreviousTerm",value:function(a){var b=this._getword(a);if(b){if(this.parsed_input.equalLastWord(b))return;this.term=this.parsed_input.replaceLastWord(b),this._first_word=!1}}},{key:"_createPrediction",value:function(){if(""!==this.term){var a=this.parsed_input.completeSuggestion(this.term);return new g(a,this.probability,1,this.source)}}},{key:"_appendPrediction",value:function(a){if(this.probability=this.probability*this._calculateProbability(a),this._update_term(a),this._shouldCreatePrediction(a)&&this._predictions.push(this._createPrediction()),this._continueFn(a)){var b=this._nextModel(a);this._total_count=this._getCount(a),this._level++,this._first_word=!1,this.isFirstLevel=!1,this.word_hash=void 0,b&&this._appendPrediction(b)}}},{key:"_getPreviousProbability",value:function(a){var b=this._getCount(this.model_item),c=h.getCountfromModel(a);return c/b}},{key:"_update_term",value:function(a){this.parsed_input.isPrevious?this.term=this._nextTerm(a)+this.term:this.term=this.term+this._nextTerm(a)}},{key:"_getword",value:function(a,b){return b=b||this._get_word_hash(a),h.getSafeElement(b,i.MAP.WORD)}},{key:"_get_word_hash",value:function(a){return d.getMapHash(a[i.MODEL.WORD_HASH])}},{key:"_nextModel",value:function(a){var b=void 0;if(b=this.isFirstLevel?h.getFirstLevelNextModel(a,this.previous):h.getNextModel(a),b&&b.length>0)return h.getFirstPrediction(b)}},{key:"_nextTerm",value:function(a){var b=this._getword(a,this.word_hash);return b?this._first_word?this.parsed_input.completeWord(b):" "+b:""}},{key:"_calculateProbability",value:function(a){var b=this._getCount(a);return b/this._total_count}},{key:"_getCount",value:function(a){return this.word_hash?h.getCountfromWordHash(this.word_hash):h.getCountfromModel(a)}},{key:"_shouldCreatePrediction",value:function(a){return this._multi_prediction&&!this._isStopWord(a)&&!this.equalRemaingWord(a)}},{key:"_isStopWord",value:function(a){var b=this._getword(a,this.word_hash);return!!b&&d.isStopWord(b)}}]),a}();b.exports=l},{"./consts":9,"./indices":15,"./input_parser":16,"./loader":17,"./prediction":20,"./utils":26}],22:[function(a,b,c){var d=function(){function a(b,c){e(this,a),this.parsed_input=c,this._list=b||[]}return f(a,[{key:"isForInput",value:function(a,b){return this.parsed_input.isPrevious?void 0!==b&&this.parsed_input.original_text===b.original_text:this.parsed_input.original_text===a.original_text}},{key:"isEmpty",value:function(){return 0===this._list.length}},{key:"predictions",get:function(){return this._list}}]),a}();b.exports=d},{}],23:[function(a,b,c){var rh=a("../../../lib/rh"),d=rh._,g=rh.consts,h=a("./history_reader"),i=a("./history_predictor"),j=a("./ngram_predictor"),k=a("./input_parser"),l=a("./loader"),m=a("./merger"),n=a("./topic_counter"),o=a("./general_predictor"),p=a("./utils"),q=a("./consts"),r=a("./counting_seamaphore"),s=a("./corrector"),t=5,u=function(){function a(b){var c=this;e(this,a),this.widget=b,this._predictors=[],this._previous_predictors=[],this.initHandleKeyHash(),this.max_predictions=t,this.predicton_merger=new m([]),b.model.subscribeOnce(g("EVT_WIDGET_LOADED"),function(){c.init()})}return f(a,[{key:"init",value:function(){var a=rh.storage.fetch(g("PREV_SEARCH_KEY"));h.initHistory(a),l.init(this.create_predictors.bind(this)),this.widget.model.csubscribe("EVT_CLOSE_SEARCH_SUGGESTION",this.closeSuggestions.bind(this))}},{key:"create_predictors",value:function(){var a=new i(h,this.processResult.bind(this));this._predictors.push(a);for(var b=1;b<=l.nGram;b++){var c=new j(b,this.processResult.bind(this));c.init(),this._predictors.push(c)}for(var d=1;d<=q.previousnGram;d++){var e=new j(d,this.processResult.bind(this),(!0));e.init(),this._previous_predictors.push(e)}var f=new o(this.processResult.bind(this));this._predictors.push(f)}},{key:"showSuggestions",value:function(a){this._initSuggestions(a),this._calculateSugguestions()}},{key:"_initSuggestions",value:function(a){this._initResult(),this._initInputs(a),this._resutSeamaphore=new r(this.onResultComplete.bind(this))}},{key:"_initInputs",value:function(a){this.parsed_input=new k(a.text,(!1),a.selStart,(!1)),p.isPrevious(a)&&(this._previous_input=new k(a.text,(!1),a.selStart,(!0)))}},{key:"_calculateSugguestions",value:function(){var a=this;this._resutSeamaphore.wait(this._predictorCount()),d.each(this._predictors,function(b){b.getPredictions(a.parsed_input)}),this._previous_input&&d.each(this._previous_predictors,function(b){b.getPredictions(a._previous_input)})}},{key:"_clearPredictors",value:function(){d.each(this._predictors,function(a){a.clear()}),d.each(this._previous_predictors,function(a){a.clear()}),this._corrector&&this._corrector.clear()}},{key:"_predictorCount",value:function(){var a=this._predictors.length;return this._previous_input&&(a+=this._previous_predictors.length),a}},{key:"_initResult",value:function(){this.predicton_merger&&this.predicton_merger.clear(),this.widget.publish("selected",void 0),this._previous_input=void 0,this._computing_correction=!1}},{key:"_clearResult",value:function(){this._resetMovement(),this._previous_input=void 0,this.parsed_input=void 0,this._resutSeamaphore=void 0,this._clearPredictors()}},{key:"isSuggestionsOpen",value:function(){var a=this.widget.get(g("SEARCH_RESULTS_KEY"));return a&&a.length>0}},{key:"processResult",value:function(a){if(a.isForInput(this.parsed_input,this._previous_input)){if(!a.isEmpty()){this.predicton_merger.merge(a.predictions);var b=new n;this.predictions=b.computeCounts(this.predictions,this.parsed_input)}this._resutSeamaphore.signal()}}},{key:"onResultComplete",value:function(){this.needCorrection()&&this.doCorrection(),this.predictions.splice(this.max_predictions),this.widget.publish(g("SEARCH_RESULTS_KEY"),this.predictions),this._clearResult()}},{key:"needCorrection",value:function(){return!this._computing_correction&&0===this.predictions.length&&""!==this.parsed_input.trimmedText}},{key:"doCorrection",value:function(){this._computing_correction=!0,this._corrector=new s(this.parsed_input),this._corrector.getCorrections(this.processResult.bind(this))}},{key:"canDelete",value:function(a){var b=this.predictions[a];return void 0!==b&&b.source===q.PREDICTOR_SOURCE_ID.HISTORY_PREDICTOR}},{key:"handleDelete",value:function(a){var b=this.predictions[a];this._deleteFromHistory(b.term),this._removePrediction(a),this.widget.publish("history_deleted",!0)}},{key:"_removePrediction",value:function(a){this.predictions.splice(a,1),this.widget.publish(g("SEARCH_RESULTS_KEY"),this.predictions)}},{key:"handleClick",value:function(a){var b=this.widget.get("history_deleted");if(!b){var c=this.predictions[a];if(void 0!==c){var d=c.term;this._addToHistory(d),this.widget.publish(g("KEY_SEARCH_TERM"),d),this.widget.publish(rh.consts("EVT_SEARCH_TERM"),!0)}}}},{key:"handleFocusOut",value:function(a,b){var c=this.widget.get("history_deleted");c?(this.widget.publish("history_deleted",!1),this.widget.publish(b,!0)):this.widget.publish(a,!1)}},{key:"getFirstSuggestionIndex",value:function(a,b){return b?0:a-1}},{key:"getNextSuggestionIndex",value:function(a,b,c){var d=c?1:b-1;return a=void 0===a?0:a,a=(a+d)%b}},{key:"handleArrowKey",value:function(a){var b=this.widget.get("selected"),c=40===a.keyCode,d=this.getPredictionsLength();if(d>0){b=void 0===b?this.getFirstSuggestionIndex(d,c):this.getNextSuggestionIndex(b,d,c),this.widget.publish("selected",b);var e=this.getNewInputText(this.results[b]);this.widget.publish(g("KEY_SEARCH_TERM"),e)}}},{key:"getNewInputText",value:function(a){return a.term}},{key:"getPredictionsLength",value:function(){var a=void 0;return this.results=this.widget.get(g("SEARCH_RESULTS_KEY")),this.results&&(a=this.results.length),a}},{key:"closeSuggestions",value:function(){this._clearResult(),this.widget.publish("selected",void 0),this.original_parsed_input=void 0,this.widget.publish(g("SEARCH_RESULTS_KEY"),[])}},{key:"_deleteFromHistory",value:function(a){h["delete"](a),this._saveHistory()}},{key:"_addToHistory",value:function(a){a&&""!==a&&(h.add({text:a.trim(),count:10}),this._saveHistory())}},{key:"_saveHistory",value:function(){rh.storage.persist(g("PREV_SEARCH_KEY"),h.getHistory())}},{key:"handleShowSuggestion",value:function(a){""===a.text||p.shouldShowSuggestion(a)===!1?this.closeSuggestions():this.showSuggestions(a)}},{key:"handleReturn",value:function(a){""!==a.text&&(this._addToHistory(a.text),this.closeSuggestions())}},{key:"_isMovementKey",value:function(a){return[38,39,40].indexOf(a)>=0}},{key:"_resetMovement",value:function(){this.original_parsed_input=void 0,this.widget.publish("selected",void 0)}},{key:"_isHandlingCursorMove",value:function(){var a=this.widget.get("selected");return void 0!==a}},{key:"initHandleKeyHash",value:function(){this.handle_key_hash={up:this.handleArrowKey.bind(this),down:this.handleArrowKey.bind(this),backspace:this.handleBackSpace.bind(this),"return":this.handleReturn.bind(this),"default":this.handleShowSuggestion.bind(this),escape:this.handleEscape.bind(this),right:this.handleRight.bind(this)}}},{key:"handleRight",value:function(a){return this._isHandlingCursorMove()?(p.shouldAppendSpace(a)&&(a.text+=" ",a.selStart+=1,this.widget.publish(g("KEY_SEARCH_TERM"),a.text)),this._resetMovement(),this.handleShowSuggestion(a),!1):(this._resetMovement(),this.handleShowSuggestion(a))}},{key:"handleBackSpace",value:function(a){return this.handleShowSuggestion(a)}},{key:"handleEscape",value:function(){this.closeSuggestions()}},{key:"handleKey",value:function(a){var b=a.keyCode,c={keyCode:b,selStart:a.target.selectionStart,text:a.target.value};this._isMovementKey(b)||this._resetMovement();var e=d.getKeyIndex(b);if(void 0===e)return!0;var f=this.handle_key_hash[e];return f?f(c):void 0}},{key:"predictions",get:function(){return this.predicton_merger.predictions},set:function(a){this.predicton_merger=new m(a)}}]),a}();rh.controller("SearchController",u)},{"../../../lib/rh":3,"./consts":9,"./corrector":10,"./counting_seamaphore":11,"./general_predictor":12,"./history_predictor":13,"./history_reader":14,"./input_parser":16,"./loader":17,"./merger":18,"./ngram_predictor":19,"./topic_counter":25,"./utils":26}],24:[function(a,b,c){var d=function(){function a(b){e(this,a),this._set=b||[],this._initialised=!1}return f(a,[{key:"intersect",value:function(a){Array.isArray(a)||(a=a.set);for(var b=[],c=0,d=0,e=0;d<this._set.length&&e<a.length;)this._set[d]<a[e]?d++:this._set[d]>a[e]?e++:(b[c++]=this._set[d],d++,e++);this._set=b}},{key:"intersectOrSet",value:function(a){this._initialised?this.intersect(a):(Array.isArray(a)||(a=a.set),this.set=a,this._initialised=!0)}},{key:"intersectCount",value:function(a){Array.isArray(a)||(a=a.set);for(var b=0,c=0,d=0;c<this._set.length&&d<a.length;)this._set[c]<a[d]?c++:this._set[c]>a[d]?d++:(b++,c++,d++);return b}},{key:"set",set:function(a){this._set=a||[]},get:function(){return this._set}},{key:"length",get:function(){return this._set.length}}]),a}();b.exports=d},{}],25:[function(a,b,c){var d=a("./loader"),g=a("./sorted_set"),h=a("./input_parser"),i=a("./prediction"),rh=a("../../../lib/rh"),j=rh._,k=a("./indices"),l=function(){function a(){e(this,a),this.newPredictions=[],this.predictionSet=new g,this.inputSet=new g}return f(a,[{key:"computeCounts",value:function(a,b){var c=this;return this.newPrediction=[],this.parsed_input=b,j.each(a,function(a){c.addUpdatedPrediction(a)}),this.newPredictions}},{key:"addUpdatedPrediction",value:function(a){this.createPredictionSet(a);var b=this.computeTopicCount();if(b>0){var c=new i(a.term,a.probability,b,a.source);this.newPredictions.push(c)}}},{key:"computeTopicCount",value:function(){return this.predictionSet.set.length}},{key:"createPredictionSet",value:function(a){var b=this;this.predictionSet=new g;var c=new h(a.term,(!0));j.each(c.words,function(a,c){b._addWordToSet(a,b.predictionSet,c)})}},{key:"initInput",value:function(a){var b=this;this.inputSet=new g,j.each(a.words,function(a){b._addWordToSet(a,b.inputSet)})}},{key:"_addWordToSet",value:function(a,b){if(!d.isStopWord(a)){var c=d._getHashForWord(a);c&&c.length>k.MAP.TOPICS&&b.intersectOrSet(c[k.MAP.TOPICS])}}}]),a}();b.exports=l},{"../../../lib/rh":3,"./indices":15,"./input_parser":16,"./loader":17,"./prediction":20,"./sorted_set":24}],26:[function(b,c,d){(function(a){var d=b("./indices"),e={getNextModel:function(a){if(a&&Array.isArray(a)&&a.length>d.MODEL.NEXT_MODEL)return a[d.MODEL.NEXT_MODEL]},getFirstLevelNextModel:function(a,b){if(a&&Array.isArray(a)){if(!b&&a.length>d.FIRST_PREDICTION.NEXT)return a[d.FIRST_PREDICTION.NEXT];if(b&&a.length>d.FIRST_PREDICTION.PREVIOUS)return a[d.FIRST_PREDICTION.PREVIOUS]}},getFirstPrediction:function(a){if(a&&Array.isArray(a)&&a.length>0&&Array.isArray(a[0]))return a[0]},compareNoCase:function(b,c){return void 0!==a.compare?a.compare(b,c):b===c?0:-1},hammingDistance:function f(a,b){for(var c=Math.min(a.length,b.length),f=0,d=0;d<c;d++)a[d]!==b[d]&&f++;return a.length>c&&(f+=a.length-c),f},isPrevious:function(a){return a.selStart<a.text.length},shouldShowSuggestion:function(a){var b=a.text,c=a.selStart;return 0===c||c===b.length||b.length>0&&(" "===b[c]||" "===b[c-1])},shouldAppendSpace:function(a){var b=a.text,c=a.selStart;return b.length>0&&c===b.length&&" "!==b[b.length-1]},getSafeElement:function(a,b){if(a&&Array.isArray(a)&&a.length>b)return a[b]},getCountfromModel:function(a){return Array.isArray(a)&&a.length>d.MODEL.COUNT?a[d.MODEL.COUNT]:0},getCountfromWordHash:function(a){return Array.isArray(a)&&a.length>d.MAP.COUNT?a[d.MAP.COUNT]:0}};c.exports=e}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof a?a:{})},{"./indices":15}],27:[function(a,b,c){var rh=a("../../lib/rh"),d=rh._,g=rh.consts,h=function(){function a(b){e(this,a),this.widget=b}return f(a,[{key:"getLink",value:function(a){var b=a,c=this.widget.get(g("KEY_SEARCH_RESULT_PARAMS")),e=this.widget.get(g("KEY_SEARCH_TERM")),f="";if(e&&""!==e){var h=g("HASH_KEY_RH_SEARCH"),i={};i[h]=e,f=d.mapToEncodedString(i)}return void 0!==c&&""!==c?b=b+c+"&"+f:""!==f&&(b=b+"?"+f),b}}]),a}();rh.controller("SearchResultController",h)},{"../../lib/rh":3}],28:[function(a,b,c){var rh=a("../../lib/rh"),d=rh._,g=rh.consts,h=function(){function a(b){e(this,a),this.widget=b}return f(a,[{key:"select",value:function(a,b){this.widget.publish(g("KEY_TOC_SELECT_ITEM"),{id:a,url:b})}},{key:"getLink",value:function(a){if(a){var b=this.widget.get(g("KEY_TOC_BREADCRUMBS")),c=b[a];if(c&&c.hasUrl)return c.url}}},{key:"goToHome",value:function(a){if(a){var b=this.widget.get(g("KEY_TOC_BREADCRUMBS")),c=b[a];c&&!c.hasUrl&&d.goToHome({rhtocid:c.id})}}}]),a}();rh.controller("TocBreadcrumbsController",h)},{"../../lib/rh":3}],29:[function(a,b,c){var rh=a("../../../lib/rh"),d=rh.$,g="change",h=".carousel-item:not(.hide):not(.rh-hide)",i=function(){function a(b,c){var d=this;e(this,a),this.widget=b,this.node=this.widget.node,this.tab=0,rh.model.subscribeOnce(rh.consts(c.key),function(){d.widget.publish(g,!0)}),rh.model.subscribe(rh.consts("KEY_SCREEN"),function(){d["goto"](d.tab,0)}),rh.model.subscribe(c.key+"gototab",function(a){d["goto"](d.pagecount(),a.tab)})}return f(a,[{key:"goto",value:function(a,b){var c=this;this.tab=b,this.carouselnode=d.find(this.node,".carousel")[0],this.animateLeft(a),rh._.delay(function(){c.widget.publish(g,!0)},1e3)}},{key:"hasNext",value:function(){this.carouselnode=d.find(this.node,".carousel")[0];var a=d.find(d.find(this.node,".carousel")[0],h);return a=a&&a.length>0?a[a.length-1]:null,a.offsetLeft+this.carouselnode.offsetLeft>this.carouselnode.offsetWidth}},{key:"animateLeft",value:function(){var a="calc(-"+14*this.tab+"px - "+100*this.tab+"%)";d.css(this.carouselnode,"left",a)}},{key:"next",value:function(){this["goto"](this.tab,this.tab+1)}},{key:"pagecount",value:function(){return this.tab}},{key:"previous",value:function(){this["goto"](this.tab,this.tab-1)}},{key:"ensureVisible",value:function(){}}]),a}();rh.controller("Carousel",i)},{"../../../lib/rh":3}],30:[function(a,b,c){var rh=a("../../lib/rh"),d=rh.$;b.exports={nodeType:{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12},removeChild:function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.parentNode(a);return b&&b.removeChild&&b.removeChild(a)},appendChild:function(a,b){return a&&a.appendChild&&a.appendChild(b)},parentNode:function(a){return a&&a.parentNode},childNodes:function(a){return a&&a.childNodes||[]},toHtmlNode:function(a){return this.childNodes(d.createElement("div",a))},outerHTML:function(a){return a&&a.outerHTML||""},insertAfter:function(a,b){return a.parentNode.insertBefore(b,a.nextSibling)},value:function(a){return a&&a.nodeValue},name:function(a){return a&&a.nodeName},type:function(a){return a&&a.nodeType},isElementNode:function(a){return this.type(a)===this.nodeType.ELEMENT_NODE},isTextNode:function(a){return this.type(a)===this.nodeType.TEXT_NODE}}},{"../../lib/rh":3}]},{},[4])}(window,document,window.location);